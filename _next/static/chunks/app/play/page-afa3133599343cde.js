(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{3356:(e,t,n)=>{Promise.resolve().then(n.bind(n,9963))},9963:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>D});var r=n(5155),o=n(1269),i=n.n(o),l=n(2115);function s(){let[e,t]=(0,l.useState)({windowWidth:0,windowHeight:0});return(0,l.useEffect)(()=>{t({windowWidth:1.1*window.innerWidth,windowHeight:1.1*window.innerHeight});let e=()=>{t({windowWidth:1.1*window.innerWidth,windowHeight:1.1*window.innerHeight})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}let a=e=>{let t;let n=new Set,r=(e,r)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=r?r:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,i={setState:r,getState:o,getInitialState:()=>l,subscribe:e=>(n.add(e),()=>n.delete(e))},l=t=e(r,o,i);return i},c=e=>e?a(e):a,u=e=>e,f=e=>{let t=c(e),n=e=>(function(e,t=u){let n=l.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return l.useDebugValue(n),n})(t,e);return Object.assign(n,t),n},d=e=>e?f(e):f,h=d(e=>({x:100,y:100,color:"blue",originX:100,originY:100,zoom:1,setColor:t=>e({color:t}),setX:t=>e({x:t}),setY:t=>e({y:t}),setZoom:t=>e({zoom:t}),goup:()=>e(e=>({originY:e.originY-1})),godown:()=>e(e=>({originY:e.originY+1})),goleft:()=>e(e=>({originX:e.originX-1})),goright:()=>e(e=>({originX:e.originX+1})),goUpLeft:()=>e(e=>({originX:e.originX-1,originY:e.originY-1})),goUpRight:()=>e(e=>({originX:e.originX+1,originY:e.originY-1})),goDownLeft:()=>e(e=>({originX:e.originX-1,originY:e.originY+1})),goDownRight:()=>e(e=>({originX:e.originX+1,originY:e.originY+1})),setOringinPosition:(t,n)=>e({originX:t,originY:n}),setPosition:(t,n)=>e({x:t,y:n})})),g=d(e=>({cursors:[],addCursors:t=>e(e=>({cursors:[...e.cursors,...t]})),removeCursor:t=>e(e=>({cursors:e.cursors.filter(e=>e!==t)})),setCursors:t=>e({cursors:t})}));var x=n(40),y=n.n(x);let v=JSON.parse('{"HP":{"inner":[["#8fe340","#A4E863"],["#62B628","#71C637"],["#F1FAD1","#E9F6B9"]],"outer":[["#A8EC67","#81D92C"],["#74C63C","#5BB31F"],["#E9FAAA","#F5FDD8"]]},"nf":["M219.428 109.389 C226.519 114.964 223.188 126.337 214.21 127.205 L79.8702 140.188 L115.929 28.0267 L219.428 109.389 Z","M79.9801 8.51632 C75.8798 9.72627 73.972 13.8825 73.0599 18.0591 L25.8244 234.356 C30.5707 235.401 36.0988 236 42 236 C45.1362 236 48.1671 235.831 51.0311 235.515 L116.451 28.5289 C117.573 24.9766 117.96 21.0358 115.39 18.3387 C112.87 15.6942 108.055 12.4097 98.862 9.69397 C89.7757 7.00975 83.7643 7.39963 79.9801 8.51632 Z"],"qN":[" M77.85 145.025 L0.899994 54.5752 L103.5 92.3752 L117 0.575195 L164.25 74.8252 L219.6 38.3752 L202.05 103.175 L276.3 108.575 L219.6 153.125 L287.1 223.325 L198 230.075 L177.75 312.425 L130.5 236.825 L67.05 284.075 L75.15 196.325 L11.7 177.425 L77.85 145.025 "," M67.05 104.525 L104.85 150.425 L71.1 169.325 L104.85 178.775 L100.8 226.025 L133.2 200.375 L158.85 239.525 L168.3 196.325 L218.25 192.275 L181.8 154.475 L212.85 131.525 L171 128.825 L181.8 93.7251 L152.1 113.975 L126.45 73.4751 L118.35 122.075 L67.05 104.525 "],"PN":"M12.2719 13.6437 C11.4141 6.37712 19.6676 1.61197 25.5317 5.9881 L165.217 110.229 C171.554 114.958 168.358 125.029 160.453 125.238 L100.228 126.83 C91.7695 127.053 83.9984 131.54 79.5756 138.753 L48.0844 190.114 C43.9511 196.855 33.6313 194.587 32.7043 186.735 L12.2719 13.6437 Z`","Ml":["#0059B280","#0095B280","#00B20080","#77B20080","#B2950080","#B24A0080","#B2000080","#7700B280"]}'),p=d(e=>({x:1/0,y:1/0,content:"",movecost:0,setMovecost:t=>e({movecost:t}),setPosition:(t,n,r)=>e({x:t,y:n,content:r})})),L=d(e=>({socket:null,message:"",isOpen:!1,connect:t=>{let n=new WebSocket(t);n.onopen=()=>e({socket:n,isOpen:!0}),n.onclose=()=>e({socket:null,isOpen:!1}),n.onmessage=t=>e({message:t.data})},disconnect:()=>{e(e=>{var t;return null===(t=e.socket)||void 0===t||t.close(),{socket:null,isOpen:!1}})},sendMessage:t=>{t&&e(e=>{var n;return e.isOpen&&(null===(n=e.socket)||void 0===n||n.send(t)),{}})}}));class w{constructor(e,t){this.x=e,this.y=t,this.g=1/0,this.h=0,this.f=1/0,this.parent=null}}let C=e=>{let{paddingTiles:t,tiles:n,tileSize:o,cursorOriginX:i,cursorOriginY:a,startPoint:c,leftReviveTime:u,setCachingTiles:f}=e,[d,x]=[i-c.x,a-c.y],[C,m]=[(t-1)*d/t,(t-1)*x/t],{qN:_,PN:b,nf:S,HP:E,Ml:k}=v,M={red:"#FF4D00",blue:"#0094FF",yellow:"#F0C800",purple:"#BC3FDC",0:"#FF4D00",1:"#F0C800",2:"#0094FF",3:"#BC3FDC"},{windowHeight:j,windowWidth:F}=s(),{x:R,y:A,godown:B,goleft:D,goright:P,goup:O,goDownLeft:N,goDownRight:Y,goUpLeft:I,goUpRight:T,zoom:W,color:X,setPosition:z}=h(),{setPosition:H,x:U,y:G,setMovecost:J}=p(),{cursors:Z}=g(),{sendMessage:q}=L(),K=(0,l.useRef)(null),Q={tileCanvasRef:(0,l.useRef)(null),interactionCanvasRef:(0,l.useRef)(null),otherCursorsRef:(0,l.useRef)(null)},[V,$]=(0,l.useState)(!0),[ee,et]=(0,l.useState)([]),[en,er]=(0,l.useState)({x:0,y:0}),[eo,ei]=(0,l.useState)([]),[el,es]=(0,l.useState)(),ea=()=>{K.current&&(clearInterval(K.current),K.current=null)};(0,l.useEffect)(()=>{let e=e=>{e.preventDefault()};return window.addEventListener("contextmenu",e),()=>{window.removeEventListener("contextmenu",e),ea()}},[]);let ec=e=>!["F","C"].some(t=>e.includes(t)),eu=(e,t,n,r,i)=>{if(K.current)return;let l=0,s=ey(d,x,e,t),a=s[l];if((null==a?void 0:a.x)===void 0||(null==a?void 0:a.y)===void 0)return;J(s.length-1),z(e+c.x,t+c.y);let u=(e,t)=>{let n=0,r=setInterval(()=>{let{tileCanvasRef:i,interactionCanvasRef:l,otherCursorsRef:s}=Q;if(!i.current||!l.current||!s.current)return;let a=[i.current,l.current,s.current];if(n>=1){for(let e of a)e.style.transform="0";clearInterval(r);return}let[c,u]=[e*(o-(n+=.03333333333333333)*o),t*(o-n*o)];for(let e of a)e.style.transform="translate(".concat(c,"px, ").concat(u,"px)")},200/30)};K.current=setInterval(()=>{if(++l>=s.length){ef(n,r,i),et([]),ea();return}let e=s[l];if(!e)return;let[t,o]=[Math.sign(e.x-a.x),Math.sign(e.y-a.y)];1===t&&1===o?Y():1===t&&-1===o?T():1===t&&0===o?P():-1===t&&1===o?N():-1===t&&-1===o?I():-1===t&&0===o?D():0===t&&1===o?B():0===t&&-1===o&&O(),a=e,u(t,o),et(s.slice(l))},200)},ef=(e,t,n)=>{q(JSON.stringify({event:"pointing",payload:{position:{x:e,y:t},click_type:n}}))},ed=(e,t)=>{for(let[n,r]of[[-1,0],[0,-1],[0,1],[1,0],[-1,-1],[-1,1],[1,-1],[1,1]]){let[o,l]=[i+n,a+r];if(o===e&&l===t)return!0}return!1},eh=(e,t)=>{for(let[r,o]of[[0,0],[-1,0],[0,-1],[0,1],[1,0],[-1,-1],[-1,1],[1,-1],[1,1]]){let[i,l]=[e+r,t+o];if(l>=0&&l<n.length&&i>=0&&i<n[l].length&&ec(n[l][i]))return{x:i,y:l}}return{x:1/0,y:1/0}},eg=function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=W/3.5*i;e.fillStyle=r,e.save(),e.translate(t+o/6/i,n+o/6/i),e.scale(l,l),e.fill(null==el?void 0:el.cursor),e.restore()},ex=()=>{var e;let t=null===(e=Q.otherCursorsRef.current)||void 0===e?void 0:e.getContext("2d");t&&(t.clearRect(0,0,F,j),Z.forEach(e=>{let[n,r]=[e.x-i+C,e.y-a+m];eg(t,n*o,r*o,M[e.color])}))},ey=(e,t,r,o)=>{let[i,l]=[new w(e,t),new w(r,o)],s=[...n.map(e=>[...e.map(()=>null)])];n.forEach((e,t)=>{e.forEach((e,n)=>{ec(e)&&(s[t][n]=new w(n,t))})});let a=[i],c=[];for(i.g=0,i.f=i.g+i.h;a.length>0;){let n=a.reduce((e,t)=>e.f<t.f?e:t);if(n.x===l.x&&n.y===l.y){let r=[],o=n;for(er({x:o.x-e,y:o.y-t});o;)r.unshift(o),o=o.parent;return r}for(let{node:e,isDiagonal:t}of(a=a.filter(e=>e!==n),c.push(n),function(e,t){let n=[];for(let[r,o]of[[-1,0],[0,-1],[0,1],[1,0],[-1,-1],[-1,1],[1,-1],[1,1]]){let[i,l]=[t.x+r,t.y+o];l>=0&&l<e.length&&i>=0&&i<e[l].length&&null!==e[l][i]&&n.push({node:e[l][i],isDiagonal:0!==r&&0!==o})}return n}(s,n))){if(c.includes(e))continue;let r=n.g+(t?1.5:1);r>=e.g||(a.includes(e)||a.push(e),e.parent=n,e.g=r,e.h=Math.abs(e.x-l.x)+Math.abs(e.y-l.y),e.f=e.g+e.h)}}return[]},ev=()=>{let e=Q.tileCanvasRef.current,r=Q.interactionCanvasRef.current;if(!e||!r||0===o)return;let l=e.getContext("2d"),s=r.getContext("2d");if(!l||!s)return;s.clearRect(0,0,F,j);let c=5*W,u=d/t*o,f=x/t*o,h=u+(U-i)*o,g=f+(G-a)*o,y=new Path2D("\n      M0 0\n      L".concat(o," 0\n      L").concat(o," ").concat(o,"\n      L0 ").concat(o,"\n      L0 0\n      ")),v=new Path2D("\n      M".concat(c," ").concat(c,"\n      L").concat(o-c," ").concat(c,"\n      L").concat(o-c," ").concat(o-c,"\n      L").concat(c," ").concat(o-c,"\n      L").concat(c," ").concat(c,"\n      ")),p=M[X],L=R-i-C-en.x,w=A-a-m-en.y,_=[c,c,o-2*c,o-2*c],b=[0,0,o,o],S={inner:[l.createLinearGradient(..._),l.createLinearGradient(..._),l.createLinearGradient(..._)],outer:[l.createLinearGradient(...b),l.createLinearGradient(...b),l.createLinearGradient(...b)],flag:l.createLinearGradient(36.5,212.5,36.5,259)};S.flag.addColorStop(0,"#E8E8E8"),S.flag.addColorStop(1,"transparent"),S.inner.forEach((e,t)=>{e.addColorStop(0,E.inner[t][0]),e.addColorStop(1,E.inner[t][1])}),S.outer.forEach((e,t)=>{e.addColorStop(0,E.outer[t][0]),e.addColorStop(.4,E.outer[t][0]),e.addColorStop(.6,E.outer[t][1]),e.addColorStop(1,E.outer[t][1])}),null==n||n.forEach((e,t)=>{if(null==e||e.forEach((e,n)=>{var r;if((null===(r=eo[t])||void 0===r?void 0:r[n])===e)return;let[i,a]=[(n-C)*o,(t-m)*o];if(!(i<-o)&&!(a<-o)&&!(i>F+o)&&!(a>j+o)){switch(l.save(),l.translate(i,a),e){case"C0":case"C1":case"F00":case"F01":case"FRED0":case"FRED1":case"F10":case"F11":case"FYELLOW0":case"FYELLOW1":case"F20":case"F21":case"FBLUE0":case"FBLUE1":case"F30":case"F31":case"FPURPLE0":case"FPURPLE1":{let r="0"===e.slice(-1)?0:1;if(l.fillStyle=S.outer[r],1>=Math.abs(t-x)&&1>=Math.abs(n-d)&&!(n===d&&t===x)&&e.includes("C")&&(eg(s,i,a,"#0000002f",.5),l.fillStyle="white"),l.fill(y),l.fillStyle=S.inner[r],l.fill(v),!e.includes("F"))break;l.restore(),l.save(),l.translate(i+o/6,a+o/6),l.scale(W/4.5,W/4.5),l.fillStyle=M[e.slice(1,-1).toLowerCase()],l.fill(null==el?void 0:el.flag.flag),l.fillStyle=S.flag,l.fill(null==el?void 0:el.flag.pole);break}case"O":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"B":if(l.fillStyle=S.outer[2],l.fill(y),l.fillStyle=S.inner[2],l.fill(v),"B"===e&&(l.scale(W/4,W/4),l.fillStyle="rgba(0, 0, 0, 0.6)",l.fill(null==el?void 0:el.boom.inner),l.fillStyle="rgba(0, 0, 0, 0.5)",l.fill(null==el?void 0:el.boom.outer)),l.restore(),parseInt(e)>0){let t=parseInt(e)-1;l.fillStyle=k[t],l.font=50*W+"px LOTTERIACHAB",l.textAlign="center",l.textBaseline="middle",l.fillText(e,i+o/2,a+o/2)}}l.restore()}}),t===Math.floor(3*n.length/10)){if(eg(s,u,f,p),ex(),s.beginPath(),s.strokeStyle=p,s.lineWidth=c,s.strokeRect(h+c/2,g+c/2,o-c,o-c),s.closePath(),ee.length>0){let[e,t]=[ee[0].x+L+.5,ee[0].y+w+.5];s.beginPath(),s.strokeStyle="black",s.lineWidth=o/6,s.moveTo(e*o,t*o),ee.forEach(e=>{let[t,n]=[e.x+L+.5,e.y+w+.5];s.lineTo(t*o,n*o)}),s.stroke()}ei(n)}})};return(0,l.useEffect)(()=>{if(!V){ev();return}let e=new FontFace("LOTTERIACHAB","url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2302@1.0/LOTTERIACHAB.woff2') format('woff2')");Promise.all([e.load()]).then(()=>{es({cursor:new Path2D(b),flag:{flag:new Path2D(S[0]),pole:new Path2D(S[1])},boom:{inner:new Path2D(_[0]),outer:new Path2D(_[1])}}),$(!1),document.fonts.add(e)})},[n,V,o,i,a,c,U,G,X,W]),(0,l.useEffect)(()=>ex(),[Z]),(0,r.jsx)(r.Fragment,{children:V?(0,r.jsxs)("div",{className:y().loading,children:[(0,r.jsx)("h1",{children:"Loading..."}),(0,r.jsx)("div",{className:"".concat(n.length<1?y().loadingBar:y().loadComplete)})]}):(0,r.jsxs)("div",{className:"".concat(y().canvasContainer," ").concat(u>0?y().vibration:""),children:[(0,r.jsx)("canvas",{className:y().canvas,id:"TileCanvas",ref:Q.tileCanvasRef,width:F,height:j}),(0,r.jsx)("canvas",{className:y().canvas,id:"OtherCursors",ref:Q.otherCursorsRef,width:F,height:j}),(0,r.jsx)("canvas",{className:y().canvas,id:"InteractionCanvas",ref:Q.interactionCanvasRef,width:F,height:j,onPointerDown:e=>{var t,r;let i=Q.tileCanvasRef.current;if(!i)return;let{left:l,top:s}=i.getBoundingClientRect(),[a,u]=[e.clientX-l,e.clientY-s],[d,h]=[Math.floor(a/o+C),Math.floor(u/o+m)],[g,x]=[Math.round(d+c.x),Math.round(h+c.y)];H(g,x,null!==(r=null===(t=n[h])||void 0===t?void 0:t[d])&&void 0!==r?r:"Out of bounds");let y=2===e.buttons?"SPECIAL_CLICK":"GENERAL_CLICK";if(K.current&&(ea(),f(n)),ed(g,x)){eu(d,h,g,x,y),ef(g,x,y);return}let{x:v,y:p}=eh(d,h);eu(v,p,g,x,y)}})]})})};var m=n(8173),_=n.n(m),b=n(8871),S=n.n(b),E=n(5565);function k(e){let{time:t}=e;return(0,r.jsxs)("div",{className:S().inactive,children:[(0,r.jsxs)("div",{className:S().alert,children:[(0,r.jsx)("p",{children:"You`re stunned!"}),(0,r.jsx)("p",{children:"Try Again After"}),(0,r.jsxs)("p",{children:[Math.floor(t/60),":",(t%60).toString().padStart(2,"0")]})]}),(0,r.jsxs)(_(),{target:"_blank",href:"https://forms.gle/Aub94WBWSKrwq9ud6",className:S().ad,children:[(0,r.jsx)(E.default,{src:"https://gamultong.github.io/gamulpung-client/review.png",alt:"review",width:300,height:100}),"기다리는 동안 간단한 설문 참여하기"]})]})}var M=n(7350),j=n.n(M);function F(){return(0,r.jsx)("svg",{width:"22",height:"26",viewBox:"0 0 22 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M0.436226 1.88654C0.321855 0.917668 1.42232 0.282312 2.2042 0.865797L20.8289 14.7645C21.6738 15.3951 21.2476 16.7379 20.1937 16.7657L12.1637 16.978C11.0359 17.0078 9.99976 17.606 9.41006 18.5678L5.21123 25.4159C4.66013 26.3147 3.28415 26.0124 3.16055 24.9653L0.436226 1.88654Z",fill:"white"})})}function R(){return(0,r.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M20 5L26 5C26.5523 5 27 5.44772 27 6L27 12",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,r.jsx)("path",{d:"M12 27L6 27C5.44772 27 5 26.5523 5 26L5 20",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,r.jsx)("path",{d:"M5 12L5 6C5 5.44772 5.44772 5 6 5L12 5",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,r.jsx)("path",{d:"M27 20L27 26C27 26.5523 26.5523 27 26 27L20 27",stroke:"white",strokeWidth:"4",strokeLinecap:"round"})]})}function A(){return(0,r.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("circle",{cx:"14",cy:"14",r:"9",stroke:"white",strokeWidth:"4"}),(0,r.jsx)("path",{d:"M27 27L21.5 21.5",stroke:"white",strokeWidth:"4",strokeLinecap:"round"})]})}function B(){let{zoom:e,setZoom:t,originX:n,originY:o}=h(),{x:i,y:l}=p();return(0,r.jsxs)("div",{className:j().dashboard,children:[(0,r.jsxs)("div",{className:j().coordinates,children:[(0,r.jsxs)("p",{children:["\xa0",(0,r.jsx)(F,{}),"(",n,", ",o,")"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)(R,{}),"\xa0(",i===1/0?"":i,", ",l===1/0?"":l,")"]})]}),(0,r.jsxs)("div",{className:j().zoom,children:[(0,r.jsxs)("p",{children:[(0,r.jsx)(A,{}),"\xa0",Math.ceil(100*e),"%"]}),(0,r.jsxs)("div",{className:j().buttons,children:[(0,r.jsx)("button",{onClick:()=>t(e/1.5>.15?e/1.5:e),children:"-"}),(0,r.jsx)("button",{onClick:()=>t(1.5*e<1.7?1.5*e:e),children:"+"})]})]})]})}function D(){let e="".concat("wss://a4ed-152-67-203-244.ngrok-free.app","/session"),{isOpen:t,message:n,sendMessage:o,connect:a,disconnect:c}=L(),{x:u,y:f,setColor:d,setPosition:x,zoom:y,setZoom:v,originX:w,originY:m,setOringinPosition:_}=h(),{setCursors:b,addCursors:S,cursors:E}=g(),{setPosition:M}=p(),{windowWidth:j,windowHeight:F}=s(),[R,A]=(0,l.useState)(0),[D,P]=(0,l.useState)({x:0,y:0}),[O,N]=(0,l.useState)({x:0,y:0}),[Y,I]=(0,l.useState)({x:0,y:0}),[T,W]=(0,l.useState)([]),[X,z]=(0,l.useState)([...T.map(e=>[...e])]),[H,U]=(0,l.useState)(-1),[G,J]=(0,l.useState)(!1),Z=(e,n,r,i,l)=>{if(!t||!G)return;let[s,a]=[Math.abs(r-e)+1,Math.abs(n-i)+1];W(e=>{let t=[...e];switch(l){case"U":for(let e=0;e<a;e++)t.unshift([...Array(s).fill("??")]),t.pop();break;case"D":for(let e=0;e<a;e++)t.push([...Array(s).fill("??")]),t.shift();break;case"L":for(let e=0;e<a;e++)t[e]=[...Array(s).fill("??"),...t[e].slice(0,-1)];break;case"R":for(let e=0;e<a;e++)t[e]=[...t[e].slice(s,t[0].length),...Array(s).fill("??")];break;case"A":t=Array.from({length:a},()=>Array.from({length:s},()=>"??"))}return t}),o(JSON.stringify({event:"fetch-tiles",payload:{start_p:{x:e,y:n},end_p:{x:r,y:i}}}))};(0,l.useEffect)(()=>(document.documentElement.style.overflow="hidden",J(!1),v(1),()=>{document.documentElement.style.overflow="auto",c()}),[]),(0,l.useEffect)(()=>{if(!t&&D.x!==O.x&&O.y!==D.y){U(-1);let[t,n]=[O.x-D.x+1,O.y-D.y+1];a(e+"?view_width=".concat(t,"&view_height=").concat(n))}},[t,D,O]);let q=e=>{let t=e.match(/.{1,2}/g);if(!t)return"";let n=t.map(e=>parseInt(e,16).toString(2).padStart(8,"0")).join(""),r="1"===n[0],o="1"===n[1],i="1"===n[2],l=parseInt(n.slice(3,5),2).toString(),s=parseInt(n.slice(5),2);return r?o?"B":0===s?"O":s.toString():i?"F"+l:"C"},K=(e,t,n,r,o)=>{let[i,l]=[2*Math.abs(e-n+1),Math.abs(r-t+1)],s=[];for(let e=0;e<l;e++){let t=[],n=o.slice(e*i,(e+1)*i);for(let e=0;e<i/2;e++){let r=n.slice(2*e,2*e+2);t[e]=q(r)}s[e]=t}return s.reverse(),{rowlength:i,columnlength:l,sortedTiles:s}},Q=(e,t,n,r,o,i)=>{if(0===o.length)return;let{rowlength:l,columnlength:s,sortedTiles:a}=K(e,t,n,r,o),c=[...T];for(let e=0;e<s;e++){var u;let r=e;"All"===i&&f<t&&(r+=O.y-D.y-s+1),"PART"===i&&(r+=t-D.y),c[r]=null!==(u=c[r])&&void 0!==u?u:[];for(let o=0;o<l;o++){let i=a[e][o];["C","F"].some(e=>null==i?void 0:i.includes(e))&&(i+=(e-t+o-n)%2==0?"0":"1"),i&&(c[r][o+n-D.x]=i)}}W(c)};return(0,l.useEffect)(()=>{if(n)try{let{event:t,payload:r}=JSON.parse(n);switch(t){case"tiles":{let{tiles:e,start_p:t,end_p:n}=r,{x:o,y:i}=t,{x:l,y:s}=n;Q(l,s,o,i,e,"All");break}case"flag-set":{let{position:e,is_set:t,color:n}=r,{x:o,y:i}=e,l=[...T];l[i-D.y][o-D.x]=(t?"F"+n:"C")+((o+i)%2==0?"0":"1"),W(l);break}case"single-tile-opened":{let{position:e,tile:t}=r,{x:n,y:o}=e,i=[...T];i[o-D.y][n-D.x]=q(t),W(i);break}case"tiles-opened":{let{tiles:e,start_p:t,end_p:n}=r,{x:o,y:i}=t,{x:l,y:s}=n;Q(l,s,o,i,e,"PART");break}case"my-cursor":{let{position:e,pointer:t,color:n}=r;_(e.x,e.y),x(e.x,e.y),d(n.toLowerCase()),t&&M(t.x,t.y,""),setTimeout(()=>J(!0),0);break}case"you-died":{var e;let{revive_at:t}=r,n=Math.floor((((e=new Date(t),void 0===e)?void 0:e.getTime())-Date.now())/1e3);U(n);break}case"cursors":{let{cursors:e}=r,t=e.map(e=>{let{position:{x:t,y:n},color:r}=e;return{x:t,y:n,color:r.toLowerCase()}});S(t);break}case"moved":{let{origin_position:e,new_position:t,color:n}=r,{x:o,y:i}=e,{x:l,y:s}=t,a=[...E],c=a.findIndex(e=>{let{x:t,y:r,color:l}=e;return t===o&&r===i&&l===n.toLowerCase()});-1!==c&&(a[c]={x:l,y:s,color:n.toLowerCase()}),b(a);break}case"cursor-quit":{let{color:e,position:t}=r,n=[...E],o=n.findIndex(n=>{let{x:r,y:o,color:i}=n;return r===t.x&&o===t.y&&i===e.toLowerCase()});-1!==o&&n.splice(o,1),b(n);break}case"error":{let{msg:e}=r;console.error(e)}}}catch(e){console.error(e)}},[n]),(0,l.useEffect)(()=>{let e=[...T.map(e=>[...e.map(()=>"??")])];for(let r=0;r<T.length;r++){let o=r+m-f;for(let i=0;i<T[r].length;i++){var t,n;let l=i+w-u;(null===(t=T[o])||void 0===t?void 0:t[l])&&(e[r][i]=(null===(n=T[o])||void 0===n?void 0:n[l])||"??")}}z(e)},[T,w,m]),(0,l.useEffect)(()=>{let e=80*y,[t,n]=[Math.floor(2*j/e/2),Math.floor(2*F/e/2)];n<1||t<1||(P({x:u-t,y:f-n}),N({x:u+t,y:f+n}),I({x:w-t,y:m-n}),A(e))},[j,F,y,w,m,u,f,2,G]),(0,l.useEffect)(()=>{if(!G)return;let e=80*y,[t,n]=[Math.floor(2*j/e),Math.floor(2*F/e)],[r,i]=[Math.floor(t/2),Math.floor(n/2)],[l,s]=[0,0];t>O.x-D.x+1||n>O.y-D.y+1?(l=Math.floor(i-(O.y-D.y)/2),s=Math.round(r-(O.x-D.x)/2)):(l=-Math.round((O.y-D.y-n)/2),s=-Math.round((O.x-D.x-t)/2)),Z(D.x-s,O.y+l,O.x+s,D.y-l,"A"),o(JSON.stringify({event:"set-view-size",payload:{width:Math.floor(Math.floor(2*j/e)),height:Math.floor(Math.floor(2*F/e))}}))},[j,F,y,2,G]),(0,l.useEffect)(()=>{let[e,t]=[u-w,f-m],[n,r]=[e<0,e>0],[o,i]=[t<0,t>0],{upfrom:l,upto:s,downfrom:a,downto:c,leftfrom:d,leftto:h,rightfrom:g,rightto:x}={upfrom:D.y-1,upto:D.y+t,downfrom:O.y+t,downto:O.y+1,leftfrom:D.x+e,leftto:D.x-1,rightfrom:O.x+1,rightto:O.x+e};r&&i?(Z(g,a,x,s,"R"),Z(d,a,x,c,"D")):n&&i?(Z(d,a,h,s,"L"),Z(d,a,x,c,"D")):r&&o?(Z(g,a,x,s,"R"),Z(d,l,x,s,"U")):n&&o?(Z(d,a,h,s,"L"),Z(d,l,x,s,"U")):r?Z(g,O.y,x,D.y,"R"):n?Z(d,O.y,h,D.y,"L"):i?Z(D.x,a,O.x,c,"D"):o&&Z(D.x,l,O.x,s,"U")},[u,f]),(0,l.useEffect)(()=>{G&&o(JSON.stringify({event:"moving",payload:{position:{x:w,y:m}}}))},[w,m]),(0,l.useEffect)(()=>{setTimeout(()=>U(e=>e>0?--e:e),1e3)},[H]),(0,r.jsxs)("div",{className:i().page,children:[H>0&&(0,r.jsx)(k,{time:H}),(0,r.jsx)(B,{}),(0,r.jsx)(C,{leftReviveTime:H,paddingTiles:2,tiles:X,setCachingTiles:W,tileSize:R,startPoint:Y,cursorOriginX:w,cursorOriginY:m})]})}},1269:e=>{e.exports={page:"page_page__9CbJ0"}},40:e=>{e.exports={loading:"style_loading__42LVe",loadingBar:"style_loadingBar__AtBJr",loadingAnimation:"style_loadingAnimation__ScSQQ",loadComplete:"style_loadComplete__SRD5Z",canvasContainer:"style_canvasContainer__nKMjH",canvas:"style_canvas__m8mJO",vibration:"style_vibration__6_Fiw"}},7350:e=>{e.exports={dashboard:"style_dashboard__nDsof",coordinates:"style_coordinates__3RzzR",zoom:"style_zoom__EWfUf",buttons:"style_buttons__zf0nF"}},8871:e=>{e.exports={inactive:"style_inactive__B_gRa",fade:"style_fade__sZevv",alert:"style_alert__pv_lG",ad:"style_ad__2DN3O"}}},e=>{var t=t=>e(e.s=t);e.O(0,[991,173,565,441,517,358],()=>t(3356)),_N_E=e.O()}]);