(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6124:function(e,t,n){Promise.resolve().then(n.bind(n,1496))},1496:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return X}});var o=n(7437),i=n(7397),r=n.n(i),s=n(2265),l=n(8144),a=n(3011);let c=(0,a.U)(e=>({id:"",x:100,y:100,color:"blue",originX:100,originY:100,zoom:1,setId:t=>e({id:t}),setColor:t=>e({color:t}),setX:t=>e({x:t}),setY:t=>e({y:t}),setZoom:t=>e({zoom:t}),goup:()=>e(e=>({originY:e.originY-1})),godown:()=>e(e=>({originY:e.originY+1})),goleft:()=>e(e=>({originX:e.originX-1})),goright:()=>e(e=>({originX:e.originX+1})),goUpLeft:()=>e(e=>({originX:e.originX-1,originY:e.originY-1})),goUpRight:()=>e(e=>({originX:e.originX+1,originY:e.originY-1})),goDownLeft:()=>e(e=>({originX:e.originX-1,originY:e.originY+1})),goDownRight:()=>e(e=>({originX:e.originX+1,originY:e.originY+1})),setOringinPosition:(t,n)=>e({originX:t,originY:n}),setPosition:(t,n)=>e({x:t,y:n})})),d=(0,a.U)(e=>({cursors:[],addCursors:t=>e(e=>({cursors:[...e.cursors,...t]})),removeCursor:t=>e(e=>({cursors:e.cursors.filter(e=>e!==t)})),setCursors:t=>e({cursors:t})}));var u=n(6507),h=n.n(u),f=JSON.parse('{"tileColors":{"inner":[["#8fe340","#A4E863"],["#62B628","#71C637"],["#F1FAD1","#E9F6B9"]],"outer":[["#A8EC67","#81D92C"],["#74C63C","#5BB31F"],["#E9FAAA","#F5FDD8"]]},"flagPaths":["M219.428 109.389 C226.519 114.964 223.188 126.337 214.21 127.205 L79.8702 140.188 L115.929 28.0267 L219.428 109.389 Z","M79.9801 8.51632 C75.8798 9.72627 73.972 13.8825 73.0599 18.0591 L25.8244 234.356 C30.5707 235.401 36.0988 236 42 236 C45.1362 236 48.1671 235.831 51.0311 235.515 L116.451 28.5289 C117.573 24.9766 117.96 21.0358 115.39 18.3387 C112.87 15.6942 108.055 12.4097 98.862 9.69397 C89.7757 7.00975 83.7643 7.39963 79.9801 8.51632 Z"],"boomPaths":[" M77.85 145.025 L0.899994 54.5752 L103.5 92.3752 L117 0.575195 L164.25 74.8252 L219.6 38.3752 L202.05 103.175 L276.3 108.575 L219.6 153.125 L287.1 223.325 L198 230.075 L177.75 312.425 L130.5 236.825 L67.05 284.075 L75.15 196.325 L11.7 177.425 L77.85 145.025 "," M67.05 104.525 L104.85 150.425 L71.1 169.325 L104.85 178.775 L100.8 226.025 L133.2 200.375 L158.85 239.525 L168.3 196.325 L218.25 192.275 L181.8 154.475 L212.85 131.525 L171 128.825 L181.8 93.7251 L152.1 113.975 L126.45 73.4751 L118.35 122.075 L67.05 104.525 "],"cursorPaths":"M12.2719 13.6437 C11.4141 6.37712 19.6676 1.61197 25.5317 5.9881 L165.217 110.229 C171.554 114.958 168.358 125.029 160.453 125.238 L100.228 126.83 C91.7695 127.053 83.9984 131.54 79.5756 138.753 L48.0844 190.114 C43.9511 196.855 33.6313 194.587 32.7043 186.735 L12.2719 13.6437 Z`","countColors":["#0059B280","#0095B280","#00B20080","#77B20080","#B2950080","#B24A0080","#B2000080","#7700B280"],"stunPaths":["M129.815 125.662C130.503 123.446 133.497 123.446 134.185 125.662L139.22 141.887C139.527 142.878 140.409 143.549 141.404 143.549H157.699C159.924 143.549 160.849 146.53 159.049 147.899L145.866 157.927C145.061 158.539 144.724 159.625 145.032 160.616L150.067 176.841C150.755 179.057 148.333 180.899 146.533 179.53L133.35 169.502C132.545 168.89 131.455 168.89 130.65 169.502L117.467 179.53C115.667 180.899 113.245 179.057 113.933 176.841L118.968 160.616C119.276 159.625 118.939 158.539 118.134 157.927L104.951 147.899C103.151 146.53 104.076 143.549 106.301 143.549H122.596C123.591 143.549 124.473 142.878 124.78 141.887L129.815 125.662Z","M194.44 89.187C194.931 87.6043 197.069 87.6043 197.56 89.187L201.157 100.776C201.377 101.484 202.007 101.963 202.717 101.963H214.356C215.946 101.963 216.606 104.093 215.321 105.071L205.905 112.234C205.329 112.671 205.089 113.446 205.309 114.154L208.905 125.744C209.396 127.326 207.666 128.642 206.38 127.664L196.964 120.501C196.389 120.064 195.611 120.064 195.036 120.501L185.62 127.664C184.334 128.642 182.604 127.326 183.095 125.744L186.691 114.154C186.911 113.446 186.671 112.671 186.095 112.234L176.679 105.071C175.394 104.093 176.054 101.963 177.644 101.963H189.283C189.993 101.963 190.623 101.484 190.843 100.776L194.44 89.187Z","M170 93.7976C170 90.9223 167.92 88.439 165.054 88.2051C163.391 88.0694 161.705 88 160 88C139.889 88 122.445 97.66 113.794 111.795C111.465 115.603 114.57 120 119.034 120C121.483 120 123.681 118.599 125.072 116.583C131.592 107.134 144.005 100 160 100C160.973 100 161.933 100.026 162.879 100.078C166.586 100.281 170 97.5106 170 93.7976ZM206 132C202.686 132 200.06 134.723 199.266 137.94C196.313 149.9 184.652 160.816 167.768 163.416C164.571 163.908 162 166.522 162 169.756C162 173.154 164.823 175.908 168.191 175.457C190.725 172.44 208.443 157.177 211.524 137.977C212.049 134.705 209.314 132 206 132Z"]}');let g=(0,a.U)(e=>({x:1/0,y:1/0,content:"",movecost:0,setMovecost:t=>e({movecost:t}),setPosition:(t,n,o)=>e({x:t,y:n,content:o})})),x=(0,a.U)(e=>({socket:null,message:"",isOpen:!1,connect:t=>{let n=new WebSocket(t);n.onopen=()=>e({socket:n,isOpen:!0}),n.onclose=()=>e({socket:null,isOpen:!1}),n.onmessage=t=>e({message:t.data})},disconnect:()=>{e(e=>{var t;return null===(t=e.socket)||void 0===t||t.close(),{socket:null,isOpen:!1}})},sendMessage:t=>{t&&e(e=>{var n;return e.isOpen&&(null===(n=e.socket)||void 0===n||n.send(t)),{}})}}));var p=n(2698),m=n.n(p);function v(){let[e,t]=(0,s.useState)(""),[n,i]=(0,s.useState)(0),[r,a]=(0,s.useState)(0),[u,h]=(0,s.useState)(Date.now()),{sendMessage:f}=x(),{color:g,originX:p,originY:v,zoom:y}=c(),{cursors:w}=d(),{windowHeight:C,windowWidth:L}=(0,l.Z)(),k=(0,s.useRef)(null),_=(0,s.useRef)(null),j=e=>e?e-u>4e3?1:(e-u)/4e3:0,E={left:"51%",top:"51%",backgroundColor:g,opacity:j(r)};(0,s.useEffect)(()=>{_.current&&i(null==_?void 0:_.current.getBoundingClientRect().width)},[e]);let b=e=>{if("Enter"===e.key){var n;null===(n=k.current)||void 0===n||n.focus()}"Escape"===e.key&&(t(""),a(null))};return(0,s.useEffect)(()=>(window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)),[]),(0,s.useEffect)(()=>{setTimeout(()=>h(Date.now()),1e3)},[u]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("form",{className:m().chat,onSubmit:n=>{n.preventDefault(),a(Date.now()+8e3),""===e||r<u||(f(JSON.stringify({event:"send-chat",payload:{message:e}})),t(""))},style:E,children:[(0,o.jsx)("input",{type:"text",ref:k,className:m().message,value:e,maxLength:40,onChange:e=>{t(e.target.value),a(Date.now()+8e3)},style:{width:"".concat(n+5,"px"),color:"yellow"===g?"black":"white"}}),(0,o.jsx)("div",{ref:_,"aria-hidden":!0,children:e})]}),w.map((e,t)=>(0,o.jsx)("div",{className:m().chat,style:{left:"".concat(L/2+(e.x-p-1/y/2)*y*80,"px"),top:"".concat(C/2+(e.y-v-1/y/2)*y*80,"px"),backgroundColor:e.color,color:"yellow"===e.color?"black":"white",opacity:j(e.messageTime)},children:e.message},"".concat(e.id,"-").concat(t)))]})}var y=n(4648),w=n(1442);function C(e){let{tiles:t,tileSize:n,tilePaddingWidth:i,tilePaddingHeight:r,className:a,isMoving:d}=e,u=(0,s.useMemo)(()=>["#FF4D00","#F0C800","#0094FF","#BC3FDC"],[]),{flagPaths:h,tileColors:g,countColors:x,boomPaths:p}=f,{zoom:m}=c(),{windowHeight:v,windowWidth:C}=(0,l.Z)(),[L,k]=(0,s.useState)(m),_=(0,s.useRef)({outerCachedSprite:new Map,innerCachedSprite:new Map,boomCachedSprite:new Map,flagCachedSprite:new Map}),j=(0,s.useMemo)(()=>{let e=new Map,t=(t,o)=>{let i="".concat(t,"-").concat(o,"-").concat(n);if(e.has(i))return e.get(i);let r=document.createElement("canvas");r.width=r.height=n;let s=r.getContext("2d");if(!s)return;let l=s.createLinearGradient(0,0,n,n);l.addColorStop(0,t),l.addColorStop(1,o),s.fillStyle=l,s.fillRect(0,0,n,n);let a=w.xEZ.from(r,{resolution:1e-4,scaleMode:w.aH$.NEAREST});return e.set(i,a),a};for(let e=0;e<3;e++)t(g.outer[e][0],g.outer[e][1]),t(g.inner[e][0],g.inner[e][1]);let o=document.createElement("canvas");o.width=o.height=n;let i=o.getContext("2d");if(i){i.scale(m/4,m/4);let t=new Path2D(p[0]);i.fillStyle="rgba(0, 0, 0, 0.6)",i.fill(t);let n=new Path2D(p[1]);i.fillStyle="rgba(0, 0, 0, 0.5)",i.fill(n);let r=w.xEZ.from(o,{resolution:.5,scaleMode:w.aH$.NEAREST});e.set("boom",r)}for(let t=0;t<4;t++){let o=document.createElement("canvas");o.width=o.height=n;let i=o.getContext("2d");if(!i)continue;let r=i.createLinearGradient(36.5,212.5,36.5,259);r.addColorStop(0,"#E8E8E8"),r.addColorStop(1,"transparent"),i.translate(n/6,n/6),i.scale(m/4.5,m/4.5);let s=new Path2D(h[0]),l=new Path2D(h[1]);i.fillStyle=u[t],i.fill(s),i.fillStyle=r,i.fill(l);let a=w.xEZ.from(o,{resolution:.5,scaleMode:w.aH$.NEAREST});e.set("flag-".concat(t),a)}return k(m),e},[n]),E=(0,s.useMemo)(()=>Array.from({length:8},(e,t)=>new w.pn8({fontFamily:"LOTTERIACHAB",fontSize:50*m,fill:x[t]})),[m,x]),{outerSprites:b,innerSprites:S,boomSprites:M,flagSprites:R,textElements:F}=(0,s.useMemo)(()=>{let e=[],l=[],a=[],c=[],d=[],{outerCachedSprite:u,innerCachedSprite:h,boomCachedSprite:f,flagCachedSprite:x}=_.current;for(let p=0;p<t.length;p++)for(let w=0;w<t[p].length;w++){let L=t[p][w],k=(w-i)*n,_=(p-r)*n;if(k<-n||_<-n||k>C+n||_>v+n)continue;let b="".concat(p,"-").concat(w,"-").concat(n),S=j.get("".concat(g.outer[2][0],"-").concat(g.outer[2][1],"-").concat(n)),M=j.get("".concat(g.inner[2][0],"-").concat(g.inner[2][1],"-").concat(n));if(["C","F"].includes(L[0])){let e="0"===L.slice(-1)?0:1;S=j.get("".concat(g.outer[e][0],"-").concat(g.outer[e][1],"-").concat(n)),M=j.get("".concat(g.inner[e][0],"-").concat(g.inner[e][1],"-").concat(n))}if(S){let t="".concat(S.textureCacheIds||S,"-").concat(n),i=u.get(t);i||(i=(0,o.jsx)(y.jy,{scale:.1,interactive:!1,texture:S,width:n,height:n,cacheAsBitmapResolution:.1}),u.set(t,i)),e.push((0,s.cloneElement)(i,{key:"outer-".concat(b),x:k,y:_}))}if(M){let e="".concat(M.textureCacheIds||M,"-").concat(n),t=h.get(e);if(!t){let i=n-10*m;t=(0,o.jsx)(y.jy,{scale:.1,interactive:!1,texture:M,width:i,height:i,cacheAsBitmapResolution:.1}),h.set(e,t)}l.push((0,s.cloneElement)(t,{key:"inner-".concat(b),x:k+5*m,y:_+5*m}))}if("B"===L){let e="boom-".concat(n),t=f.get(e);t||(t=(0,o.jsx)(y.jy,{scale:.1,interactive:!1,texture:j.get("boom"),width:n,height:n,cacheAsBitmapResolution:.1}),f.set(e,t)),a.push((0,s.cloneElement)(t,{key:"boom-".concat(b),x:k,y:_}))}if("F"===L[0]){let e=L[1],t="flag-".concat(e,"-").concat(n),i=x.get(t);i||(i=(0,o.jsx)(y.jy,{interactive:!1,texture:j.get("flag-".concat(e)),anchor:.5,scale:.1,width:n,height:n,cacheAsBitmapResolution:.1}),x.set(t,i)),c.push((0,s.cloneElement)(i,{key:"flag-".concat(b),x:k+n/2,y:_+n/2}))}let R=parseInt(L);R>0&&d.push((0,o.jsx)(y.xv,{text:L,x:k+n/2,y:_+n/2,resolution:.8,anchor:.5,style:E[R-1]},"text-".concat(b)))}return{outerSprites:e,innerSprites:l,boomSprites:a,flagSprites:c,textElements:d}},[t]);return j.size&&E?(0,o.jsx)(y.Hf,{id:"Tilemap",className:a,width:C,height:v,options:{backgroundColor:8421504,resolution:d?.4:.8,antialias:!1,powerPreference:"high-performance",autoDensity:!0},children:(0,o.jsxs)(y.W2,{sortableChildren:!1,interactiveChildren:!1,cacheAsBitmap:!d&&m!==L,children:[b,S,M,R,F]})}):null}class L{constructor(e,t){this.x=e,this.y=t,this.g=1/0,this.h=0,this.f=1/0,this.parent=null}}var k=e=>{let{paddingTiles:t,tiles:n,tileSize:i,cursorOriginX:r,cursorOriginY:a,startPoint:u,leftReviveTime:p,setCachingTiles:m}=e,[y,w]=[r-u.x,a-u.y],[k,_]=[(t-1)*y/t,(t-1)*w/t],{boomPaths:j,cursorPaths:E,flagPaths:b,stunPaths:S}=f,M=[[-1,0],[0,-1],[0,1],[1,0],[-1,-1],[-1,1],[1,-1],[1,1]],R={red:"#FF4D00",blue:"#0094FF",yellow:"#F0C800",purple:"#BC3FDC",0:"#FF4D00",1:"#F0C800",2:"#0094FF",3:"#BC3FDC"},F={red:"#FBCBB6",blue:"#A8DBFF",yellow:"#FFEE99",purple:"#E8BEF3",0:"#FBCBB6",1:"#A8DBFF",2:"#FFEE99",3:"#E8BEF3"},{windowHeight:B,windowWidth:P}=(0,l.Z)(),{x:D,y:A,godown:N,goleft:I,goright:O,goup:T,goDownLeft:W,goDownRight:Y,goUpLeft:Z,goUpRight:X,zoom:H,color:z,setPosition:U}=c(),{setPosition:J,x:K,y:G,setMovecost:q}=g(),{cursors:V}=d(),{sendMessage:$}=x(),Q=(0,s.useRef)(null),ee={interactionCanvasRef:(0,s.useRef)(null),otherCursorsRef:(0,s.useRef)(null),otherPointerRef:(0,s.useRef)(null),myCursorRef:(0,s.useRef)(null)},[et,en]=(0,s.useState)(!0),[eo,ei]=(0,s.useState)([]),[er,es]=(0,s.useState)({x:0,y:0}),[el,ea]=(0,s.useState)(),[ec,ed]=(0,s.useState)(),eu=()=>{Q.current&&(clearInterval(Q.current),Q.current=null)};(0,s.useEffect)(()=>{let e=e=>e.preventDefault();return window.addEventListener("contextmenu",e),()=>{window.removeEventListener("contextmenu",e),eu()}},[]);let eh=e=>!["F","C"].some(t=>e.includes(t)),ef=(e,t,n,o,s)=>{if(Q.current)return;let l=0,c=eL(y,w,e,t),d=c[l];if((null==d?void 0:d.x)===void 0||(null==d?void 0:d.y)===void 0)return;let[h,f]=[r,a];q(c.length-1),U(e+u.x,t+u.y);let g=(e,t)=>{let{interactionCanvasRef:n,otherCursorsRef:o,otherPointerRef:r}=ee,s=document.getElementById("Tilemap"),l=[n.current,o.current,r.current,s].filter(Boolean),a=performance.now(),c=n=>{let o=Math.min((n-a)/200,1),r=i*(1-o),[s,d]=[r*e,r*t];l.forEach(e=>e.style.transform="translate(".concat(s,"px, ").concat(d,"px)")),o<1?requestAnimationFrame(c):l.forEach(e=>e.style.transform="translate(0, 0)")};requestAnimationFrame(c)};Q.current=setInterval(()=>{if(++l>=c.length){eg(n,o,s),ei([]),eu();return}let e=c[l];if(!e)return;let[t,i]=[Math.sign(e.x-d.x),Math.sign(e.y-d.y)];ea({x:t,y:i}),1===t&&1===i?Y():1===t&&-1===i?X():1===t&&0===i?O():-1===t&&1===i?W():-1===t&&-1===i?Z():-1===t&&0===i?I():0===t&&1===i?N():0===t&&-1===i&&T(),[h,f]=[t+h,i+f],d=e,ei(c.slice(l)),H<.4||g(t,i)},200)},eg=(e,t,n)=>{$(JSON.stringify({event:"pointing",payload:{position:{x:e,y:t},click_type:n}}))},ex=(e,t)=>M.some(n=>{let[o,i]=n;return r+o===e&&a+i===t}),ep=(e,t)=>{for(let[i,r]of[[0,0],...M]){var o;let[s,l]=[e+i,t+r];if((null===(o=n[l])||void 0===o?void 0:o[s])&&eh(n[l][s]))return{x:s,y:l}}return{x:1/0,y:1/0}},em=function(e,t,n,o,r,s){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;e.save();let a=H/3.5*l;if(e.fillStyle=o,null!==s){let[o,r]=[2*Math.cos(s-1/4)*Math.PI,2*Math.sin(s-1/4)*Math.PI];e.translate(t-o*i/18/l+i/2,n-r*i/18/l+i/2),e.rotate(s-Math.PI/24*8)}else e.translate(t+i/6/l,n+i/6/l);if(e.scale(a,a),e.fill(null==ec?void 0:ec.cursor),e.restore(),r&&Date.now()<r&&(null==ec?void 0:ec.stun)){let o=H/2*l;e.save(),e.translate(t-i/2/l,n-i/2/l),e.fillStyle="white",e.strokeStyle="black",e.scale(o,o);for(let t=0;t<(null==ec?void 0:ec.stun.length);t++)e.fill(ec.stun[t]),e.stroke(ec.stun[t])}e.restore()},ev=()=>{var e;let t=null===(e=ee.otherCursorsRef.current)||void 0===e?void 0:e.getContext("2d");t&&(t.clearRect(0,0,P,B),V.forEach(e=>{var n,o,s,l;let[c,d]=[e.x-r+k/2,e.y-a+_/2],[u,h]=[e.x-(null!==(s=null===(n=e.pointer)||void 0===n?void 0:n.x)&&void 0!==s?s:e.x),e.y-(null!==(l=null===(o=e.pointer)||void 0===o?void 0:o.y)&&void 0!==l?l:e.y)],f=null;(0!==u||0!==h)&&(f=Math.atan2(h,u)),em(t,c*i,d*i,R[e.color],e.revive_at||null,f)}))},ey=(e,t,n,o,r)=>{e&&(e.beginPath(),e.strokeStyle=o,e.lineWidth=r,e.strokeRect(t+r/2,n+r/2,i-r,i-r),e.closePath())},ew=e=>{var t;let n=null===(t=ee.otherPointerRef.current)||void 0===t?void 0:t.getContext("2d");n&&(n.clearRect(0,0,P,B),V.forEach(t=>{var o,s;let[l,c]=[(null===(o=t.pointer)||void 0===o?void 0:o.x)-r+k/2,(null===(s=t.pointer)||void 0===s?void 0:s.y)-a+_/2];ey(n,l*i,c*i,F[t.color],e)}))},eC=(e,t)=>V.some(n=>n.x===e+u.x&&n.y===t+u.y),eL=(e,t,o,i)=>{let[r,s]=[new L(e,t),new L(o,i)],l=n.map((e,t)=>e.map((e,n)=>eh(e)?new L(n,t):null)),a=[r],c=[];for(r.g=0,r.f=r.g+r.h;a.length>0;){let n=a.reduce((e,t)=>e.f<t.f?e:t);if(n.x===s.x&&n.y===s.y){let o=[],i=n;for(es({x:i.x-e,y:i.y-t});i;)o.unshift(i),i=i.parent;return o}for(let{node:e,isDiagonal:t}of(a=a.filter(e=>e!==n),c.push(n),function(e,t){let n=[];for(let[o,i]of M){let[r,s]=[t.x+o,t.y+i];s>=0&&s<e.length&&r>=0&&r<e[s].length&&null!==e[s][r]&&!eC(r,s)&&n.push({node:e[s][r],isDiagonal:0!==o&&0!==i})}return n}(l,n))){if(c.includes(e))continue;let o=n.g+(t?1.5:1);o>=e.g||(a.includes(e)||a.push(e),e.parent=n,e.g=o,e.h=Math.abs(e.x-s.x)+Math.abs(e.y-s.y),e.f=e.g+e.h)}}return[]},ek=()=>{let{interactionCanvasRef:{current:e},myCursorRef:{current:n},otherCursorsRef:{current:o},otherPointerRef:{current:s}}=ee;if(!e||!n||!o||!s)return;let[l,c]=[e.getContext("2d"),n.getContext("2d")];if(!l||!c)return;c.clearRect(0,0,P,B),l.clearRect(0,0,P,B);let d=R[z],u=5*H,h={x:y/t*i,y:w/t*i},f={x:h.x+(K-r)*i,y:h.y+(G-a)*i},g={x:D-r-k-er.x,y:A-a-_-er.y},x=(r!==K||a!==G)&&el?Math.atan2(-el.y,-el.x):null;if(em(c,h.x,h.y,d,null,x),ey(l,f.x,f.y,d,u),ev(),ew(u),eo.length>0){let[e,t]=[eo[0].x+g.x+.5,eo[0].y+g.y+.5];l.beginPath(),l.strokeStyle="black",l.lineWidth=i/6,l.moveTo(e*i,t*i),eo.forEach(e=>{let[t,n]=[e.x+g.x+.5,e.y+g.y+.5];l.lineTo(t*i,n*i)}),l.stroke()}};return(0,s.useEffect)(()=>{if(!et&&n.length>0)return;let e=new FontFace("LOTTERIACHAB","url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2302@1.0/LOTTERIACHAB.woff2') format('woff2')");Promise.all([e.load()]).then(()=>{let t=new Path2D(E);ed({cursor:t,stun:[new Path2D(S[0]),new Path2D(S[1]),new Path2D(S[2])],flag:{flag:new Path2D(b[0]),pole:new Path2D(b[1])},boom:{inner:new Path2D(j[0]),outer:new Path2D(j[1])}}),en(!1),document.fonts.add(e)})},[n,et,i,H]),(0,s.useEffect)(()=>{et||ek()},[r,a,u,K,G,z,V]),(0,o.jsx)(o.Fragment,{children:et?(0,o.jsxs)("div",{className:h().loading,children:[(0,o.jsx)("h1",{children:"Loading..."}),(0,o.jsx)("div",{className:"".concat(n.length<1?h().loadingBar:h().loadComplete)})]}):(0,o.jsxs)("div",{className:"".concat(h().canvasContainer," ").concat(p>0?h().vibration:""),children:[(0,o.jsx)(v,{}),(0,o.jsx)(C,{isMoving:eo.length>0,tilePaddingHeight:_,tilePaddingWidth:k,tileSize:i,tiles:n,className:h().canvas}),(0,o.jsx)("canvas",{className:h().canvas,id:"OtherCursors",ref:ee.otherCursorsRef,width:P,height:B}),(0,o.jsx)("canvas",{className:h().canvas,id:"OtherPointer",ref:ee.otherPointerRef,width:P,height:B}),(0,o.jsx)("canvas",{className:h().canvas,id:"MyCursor",ref:ee.myCursorRef,width:P,height:B}),(0,o.jsx)("canvas",{className:h().canvas,id:"InteractionCanvas",ref:ee.interactionCanvasRef,width:P,height:B,onPointerDown:e=>{var t,o;let r=ee.interactionCanvasRef.current;if(!r)return;let{left:s,top:l}=r.getBoundingClientRect(),[a,c]=[e.clientX-s,e.clientY-l],[d,h]=[Math.floor(a/i+k),Math.floor(c/i+_)],[f,g]=[Math.round(d+u.x),Math.round(h+u.y)],x=null!==(o=null===(t=n[h])||void 0===t?void 0:t[d])&&void 0!==o?o:"Out of bounds";J(f,g,x);let p=2===e.buttons?"SPECIAL_CLICK":"GENERAL_CLICK";if(Q.current&&(eu(),m(n)),eg(f,g,p),"SPECIAL_CLICK"===p&&!x.includes("C"))return;let{x:v,y:y}=ep(d,h);ex(f,g)&&([v,y]=[d,h]),ef(v,y,f,g,p)}})]})})},_=n(2723),j=n.n(_);function E(e){let{time:t}=e;return(0,o.jsxs)("div",{className:j().inactive,children:[(0,o.jsxs)("div",{className:j().alert,children:[(0,o.jsx)("p",{children:"You`re stunned!"}),(0,o.jsx)("p",{children:"Try Again After"}),(0,o.jsxs)("p",{children:[Math.floor(t/60),":",(t%60).toString().padStart(2,"0")]})]}),(0,o.jsx)("div",{className:j().ad,children:"광고 받습니다: kkh061101@naver.com"})]})}var b=n(6324),S=n.n(b);function M(){return(0,o.jsx)("svg",{width:"22",height:"26",viewBox:"0 0 22 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M0.436226 1.88654C0.321855 0.917668 1.42232 0.282312 2.2042 0.865797L20.8289 14.7645C21.6738 15.3951 21.2476 16.7379 20.1937 16.7657L12.1637 16.978C11.0359 17.0078 9.99976 17.606 9.41006 18.5678L5.21123 25.4159C4.66013 26.3147 3.28415 26.0124 3.16055 24.9653L0.436226 1.88654Z",fill:"white"})})}function R(){return(0,o.jsx)("svg",{width:"24",height:"14",viewBox:"0 0 24 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M2 2L11.5286 11.5286C11.7889 11.7889 12.2111 11.7889 12.4714 11.5286L22 2",stroke:"white","stroke-width":"4","stroke-linecap":"round"})})}function F(){return(0,o.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("path",{d:"M20 5L26 5C26.5523 5 27 5.44772 27 6L27 12",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M12 27L6 27C5.44772 27 5 26.5523 5 26L5 20",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M5 12L5 6C5 5.44772 5.44772 5 6 5L12 5",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M27 20L27 26C27 26.5523 26.5523 27 26 27L20 27",stroke:"white",strokeWidth:"4",strokeLinecap:"round"})]})}function B(){return(0,o.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("circle",{cx:"14",cy:"14",r:"9",stroke:"white",strokeWidth:"4"}),(0,o.jsx)("path",{d:"M27 27L21.5 21.5",stroke:"white",strokeWidth:"4",strokeLinecap:"round"})]})}function P(){return(0,o.jsx)("svg",{width:"24",height:"14",viewBox:"0 0 24 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M2 12L11.5286 2.4714C11.7889 2.21105 12.2111 2.21106 12.4714 2.4714L22 12",stroke:"white","stroke-width":"4","stroke-linecap":"round"})})}function D(e){let{tileSize:t,renderRange:n,maxTileCount:i}=e,{zoom:r,setZoom:a,originX:d,originY:u}=c(),{windowWidth:h,windowHeight:f}=(0,l.Z)(),{x:x,y:p}=g(),m=()=>h*n/(t/1.5)+f*n/(t/1.5)>i,[v,y]=(0,s.useState)(!0);return(0,o.jsx)("div",{className:S().dashboard,children:(0,o.jsxs)("div",{className:S().bottom,children:[(0,o.jsxs)("div",{className:S().toggle,onPointerDown:()=>y(!v),children:[!v&&(0,o.jsx)(R,{}),v&&(0,o.jsx)(P,{})]}),v&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:S().coordinates,children:[(0,o.jsxs)("p",{children:["\xa0",(0,o.jsx)(M,{}),"(",d,", ",u,")"]}),(0,o.jsxs)("p",{children:[(0,o.jsx)(F,{}),"\xa0(",x===1/0?"":x,", ",p===1/0?"":p,")"]})]}),(0,o.jsxs)("div",{className:S().zoom,children:[(0,o.jsxs)("p",{children:[(0,o.jsx)(B,{}),"\xa0",Math.ceil(100*r),"%"]}),(0,o.jsxs)("div",{className:S().buttons,children:[(0,o.jsx)("button",{onPointerDown:()=>{r/1.5<.15||m()||a(r/1.5)},children:"-"}),(0,o.jsx)("button",{onPointerDown:()=>{1.5*r>1.7||a(1.5*r)},children:"+"})]})]})]})]})})}var A=n(1071),N=n.n(A),I=n(3145),O=JSON.parse('{"a":[{"id":1,"gif":"/mainvideos/moving.gif","description":{"en":"Click Open Tile to move cursor","ko":"열린 타일을 클릭하여 커서를 이동하세요"}},{"id":2,"gif":"/mainvideos/block.gif","description":{"en":"If the path to the tile you clicked is blocked, you cannot move.","ko":"클릭한 타일로 가는 길이 막혀있을 경우 이동이 되지 않습니다."}},{"id":3,"gif":"/mainvideos/zoom.gif","description":{"en":"Click - and + buttons to zoom in and out","ko":"확대 및 축소 버튼을 클릭하여 확대 및 축소하세요"}},{"id":4,"gif":"/mainvideos/open_tile.gif","description":{"en":"Click left mouse button on closed tile to open tile","ko":"닫힌 타일에 왼쪽 마우스 버튼을 클릭하여 타일을 엽니다"}},{"id":5,"gif":"/mainvideos/flag.gif","description":{"en":"Click right mouse button on open tile to flag tile","ko":"열린 타일에 오른쪽 마우스 버튼을 클릭하여 타일을 깃발로 표시하세요"}},{"id":6,"gif":"/mainvideos/mine.gif","description":{"en":"If the tile you clicked is a mine, you get a stun for 3 minutes","ko":"클릭한 타일이 지뢰인 경우 3분간 스턴을 받습니다"}},{"id":7,"gif":"/mainvideos/chat.gif","description":{"en":"If you click on a tile that is not a mine, the number of mines around the tile will be displayed","ko":"엔터 버튼을 누를 경우 채팅이 활성화 되며, 끄려면 ESC를 누르세요. 입력하고 엔터를 다시 누를 경우 채팅이 전송됩니다."}}]}'),T=n(9376);function W(){return(0,o.jsxs)("svg",{width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("path",{d:"M25 55L58.2322 21.7678C59.2085 20.7915 60.7915 20.7915 61.7678 21.7678L95 55",stroke:"white",strokeWidth:"10",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M25 90L58.2322 56.7678C59.2085 55.7915 60.7915 55.7915 61.7678 56.7678L95 90",stroke:"white",strokeWidth:"10",strokeLinecap:"round"})]})}function Y(){return(0,o.jsxs)("svg",{width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("path",{d:"M25 65L58.2322 98.2322C59.2085 99.2085 60.7915 99.2085 61.7678 98.2322L95 65",stroke:"white",strokeWidth:"10",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M25 30L58.2322 63.2322C59.2085 64.2085 60.7915 64.2085 61.7678 63.2322L95 30",stroke:"white",strokeWidth:"10",strokeLinecap:"round"})]})}function Z(){let e="https://gamultong.github.io/gamulpung-client",t=(0,T.useSearchParams)().get("lang")||"ko",[n,i]=(0,s.useState)(-1),r=O.a[n];return(0,s.useEffect)(()=>{"done"!==localStorage.getItem("tutorial")&&i(0)},[]),(0,o.jsx)(o.Fragment,{children:-1!==n&&(0,o.jsxs)("div",{className:N().tutorial,children:[(0,o.jsxs)("div",{className:N().button,onClick:()=>i(n>0?n-1:n),children:[n>0&&(0,o.jsx)(W,{})," "]}),(0,o.jsxs)("div",{className:N().step,children:[(0,o.jsx)(I.default,{src:"".concat(e).concat(r.gif),alt:r.gif,width:400,height:225}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("p",{children:["Step ",r.id]}),(0,o.jsx)("p",{children:r.description[t]})]})]}),(0,o.jsx)("div",{className:N().button,onClick:()=>{n<O.a.length-1?i(n+1):(i(-1),localStorage.setItem("tutorial","done"))},children:O.a.length-1>n?(0,o.jsx)(Y,{}):(0,o.jsx)(I.default,{src:"".concat(e,"/icon.png"),alt:"Play",width:88,height:88})})]})})}function X(){let e="".concat("wss://a4ed-152-67-203-244.ngrok-free.app","/session"),{isOpen:t,message:n,sendMessage:i,connect:a,disconnect:u}=x(),{x:h,y:f,setColor:p,setPosition:m,zoom:v,setZoom:y,originX:w,originY:C,setOringinPosition:L,setId:_}=c(),{setCursors:j,addCursors:b,cursors:S}=d(),{setPosition:M}=g(),{windowWidth:R,windowHeight:F}=(0,l.Z)(),[B,P]=(0,s.useState)(0),[A,N]=(0,s.useState)({x:0,y:0}),[I,O]=(0,s.useState)({x:0,y:0}),[T,W]=(0,s.useState)({x:0,y:0}),[Y,X]=(0,s.useState)([]),[H,z]=(0,s.useState)([...Y.map(e=>[...e])]),[U,J]=(0,s.useState)(-1),[K,G]=(0,s.useState)(!1),q=(e,n,o,r,s)=>{if(!t||!K)return;let[l,a]=[Math.abs(o-e)+1,Math.abs(n-r)+1];X(e=>{let t=[...e];switch(s){case"U":for(let e=0;e<a;e++)t.unshift([...Array(l).fill("??")]),t.pop();break;case"D":for(let e=0;e<a;e++)t.push([...Array(l).fill("??")]),t.shift();break;case"L":for(let e=0;e<a;e++)t[e]=[...Array(l).fill("??"),...t[e].slice(0,-1)];break;case"R":for(let e=0;e<a;e++)t[e]=[...t[e].slice(l,t[0].length),...Array(l).fill("??")];break;case"A":t=Array.from({length:a},()=>Array.from({length:l},()=>"??"))}return t}),i(JSON.stringify({event:"fetch-tiles",payload:{start_p:{x:e,y:n},end_p:{x:o,y:r}}}))};(0,s.useEffect)(()=>(document.documentElement.style.overflow="hidden",G(!1),y(1),()=>{document.documentElement.style.overflow="auto",u()}),[]),(0,s.useEffect)(()=>{if(!t&&A.x!==I.x&&I.y!==A.y){J(-1);let[t,n]=[I.x-A.x+1,I.y-A.y+1];a(e+"?view_width=".concat(t,"&view_height=").concat(n))}},[t,A,I]);let V=e=>{let t=e.match(/.{1,2}/g);if(!t)return"";let n=t.map(e=>parseInt(e,16).toString(2).padStart(8,"0")).join(""),o="1"===n[0],i="1"===n[1],r="1"===n[2],s=parseInt(n.slice(3,5),2),l=parseInt(n.slice(5),2);return o?i?"B":0===l?"O":l.toString():r?"F"+s:"C"},$=(e,t,n,o,i)=>{let[r,s]=[2*Math.abs(e-n+1),Math.abs(o-t+1)],l=[];for(let e=0;e<s;e++){let t=[],n=i.slice(e*r,(e+1)*r);for(let e=0;e<r/2;e++)t[e]=V(n.slice(2*e,2*e+2));l[e]=t}return l.reverse(),{rowlength:r,columnlength:s,sortedTiles:l}},Q=(e,t,n,o,i,r)=>{if(0===i.length)return;let{rowlength:s,columnlength:l,sortedTiles:a}=$(e,t,n,o,i),c=[...Y];for(let e=0;e<l;e++){var d;let o=e;"All"===r&&f<t&&(o+=I.y-A.y-l+1),"PART"===r&&(o+=t-A.y),c[o]=null!==(d=c[o])&&void 0!==d?d:[];for(let i=0;i<s;i++){let r=a[e][i];["C","F"].some(e=>null==r?void 0:r.includes(e))&&(r+=(e-t+i-n)%2==0?"0":"1"),r&&(c[o][i+n-A.x]=r)}}X(c)};return(0,s.useEffect)(()=>{if(n)try{var e,t,o;let{event:i,payload:r}=JSON.parse(n);switch(i){case"tiles":{let{tiles:e,start_p:t,end_p:n}=r,{x:o,y:i}=t,{x:s,y:l}=n;Q(s,l,o,i,e,"All");break}case"flag-set":{let{position:t,is_set:n,color:o}=r,{x:i,y:s}=t,l=[...Y];l[s-A.y][i-A.x]=(n?"F"+(null!==(e=({RED:"0",YELLOW:"1",BLUE:"2",PURPLE:"3"})[o])&&void 0!==e?e:o):"C")+((i+s)%2==0?"0":"1"),X(l);break}case"pointer-set":{let{id:e,pointer:t}=r,n=S.map(n=>e===n.id?{...n,pointer:t}:n);j(n)}case"single-tile-opened":{let{position:e,tile:t}=r;if(!e||!t)return;let{x:n,y:o}=e,i=[...Y];i[o-A.y][n-A.x]=V(t),X(i);break}case"tiles-opened":{let{tiles:e,start_p:t,end_p:n}=r,{x:o,y:i}=t,{x:s,y:l}=n;Q(s,l,o,i,e,"PART");break}case"my-cursor":{let{position:e,pointer:t,color:n,id:o}=r;_(o),L(e.x,e.y),m(e.x,e.y),p(n.toLowerCase()),t&&M(t.x,t.y,""),setTimeout(()=>G(!0),0);break}case"you-died":{let{revive_at:e}=r,n=Math.floor((((t=new Date(e),void 0===t)?void 0:t.getTime())-Date.now())/1e3);J(n);break}case"cursors":{let{cursors:e}=r,t=e.map(e=>{let{position:{x:t,y:n},color:o,id:i,pointer:r}=e;return{id:i,pointer:r,x:t,y:n,color:o.toLowerCase()}});b(t);break}case"cursors-died":{let{cursors:e,revive_at:t}=r,n=(o=new Date(t),void 0===o)?void 0:o.getTime(),i=S.map(t=>{for(let o of e)if(t.id===o.id)return{...t,revive_at:n};return t});j(i);break}case"moved":{let{id:e,new_position:t}=r,{x:n,y:o}=t,i=S.map(t=>e===t.id?{...t,x:n,y:o}:t);j(i);break}case"cursor-quit":{let{id:e}=r,t=[...S],n=t.findIndex(t=>t.id===e);-1!==n&&t.splice(n,1),j(t);break}case"chat":{let{cursor_id:e,message:t}=r,n=S.map(n=>n.id===e?{...n,message:t,messageTime:Date.now()+8e3}:n);j(n);break}case"error":{let{msg:e}=r;console.error(e)}}}catch(e){console.error(e)}},[n]),(0,s.useEffect)(()=>{let e=[...Y.map(e=>[...e.map(()=>"??")])];for(let o=0;o<Y.length;o++){let i=o+C-f;for(let r=0;r<Y[o].length;r++){var t,n;let s=r+w-h;(null===(t=Y[i])||void 0===t?void 0:t[s])&&(e[o][r]=(null===(n=Y[i])||void 0===n?void 0:n[s])||"??")}}z(e)},[Y,w,C]),(0,s.useEffect)(()=>{let e=80*v,[t,n]=[Math.floor(3*R/e/2),Math.floor(3*F/e/2)];n<1||t<1||(N({x:h-t,y:f-n}),O({x:h+t,y:f+n}),W({x:w-t,y:C-n}),P(e))},[R,F,v,w,C,h,f,K]),(0,s.useEffect)(()=>{if(!K)return;let e=80*v,[t,n]=[Math.floor(3*R/e),Math.floor(3*F/e)],[o,r]=[Math.floor(t/2),Math.floor(n/2)],[s,l]=[0,0];t>I.x-A.x+1||n>I.y-A.y+1?(s=Math.floor(r-(I.y-A.y)/2),l=Math.round(o-(I.x-A.x)/2)):(s=-Math.round((I.y-A.y-n)/2),l=-Math.round((I.x-A.x-t)/2)),q(A.x-l,I.y+s,I.x+l,A.y-s,"A"),i(JSON.stringify({event:"set-view-size",payload:{width:Math.floor(3*R/e),height:Math.floor(3*F/e)}}))},[R,F,v,K]),(0,s.useEffect)(()=>{let[e,t]=[h-w,f-C],[n,o]=[e<0,e>0],[i,r]=[t<0,t>0],{upfrom:s,upto:l,downfrom:a,downto:c,leftfrom:d,leftto:u,rightfrom:g,rightto:x}={upfrom:A.y-1,upto:A.y+t,downfrom:I.y+t,downto:I.y+1,leftfrom:A.x+e,leftto:A.x-1,rightfrom:I.x+1,rightto:I.x+e};o&&r?(q(g,a,x,l,"R"),q(d,a,x,c,"D")):n&&r?(q(d,a,u,l,"L"),q(d,a,x,c,"D")):o&&i?(q(g,a,x,l,"R"),q(d,s,x,l,"U")):n&&i?(q(d,a,u,l,"L"),q(d,s,x,l,"U")):o?q(g,I.y,x,A.y,"R"):n?q(d,I.y,u,A.y,"L"):r?q(A.x,a,I.x,c,"D"):i&&q(A.x,s,I.x,l,"U")},[h,f]),(0,s.useEffect)(()=>{K&&i(JSON.stringify({event:"moving",payload:{position:{x:w,y:C}}}))},[w,C]),(0,s.useEffect)(()=>{setTimeout(()=>J(e=>e>0?--e:e),1e3)},[U]),(0,o.jsxs)("div",{className:r().page,children:[U>0&&(0,o.jsx)(E,{time:U}),(0,o.jsx)(Z,{}),(0,o.jsx)(D,{tileSize:B,renderRange:3,maxTileCount:530}),(0,o.jsx)(k,{leftReviveTime:U,paddingTiles:3,tiles:H,setCachingTiles:X,tileSize:B,startPoint:T,cursorOriginX:w,cursorOriginY:C})]})}},8144:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(2265);function i(){let[e,t]=(0,o.useState)({windowWidth:0,windowHeight:0});return(0,o.useEffect)(()=>{t({windowWidth:1.1*window.innerWidth,windowHeight:1.1*window.innerHeight});let e=()=>{t({windowWidth:1.1*window.innerWidth,windowHeight:1.1*window.innerHeight})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}},7397:function(e){e.exports={page:"page_page__9CbJ0"}},6507:function(e){e.exports={loading:"style_loading__42LVe",loadingBar:"style_loadingBar__AtBJr",loadingAnimation:"style_loadingAnimation__ScSQQ",loadComplete:"style_loadComplete__SRD5Z",canvasContainer:"style_canvasContainer__nKMjH",canvas:"style_canvas__m8mJO",vibration:"style_vibration__6_Fiw"}},6324:function(e){e.exports={dashboard:"style_dashboard__nDsof",bottom:"style_bottom___8aLI",coordinates:"style_coordinates__3RzzR",toggle:"style_toggle__R68Vw",zoom:"style_zoom__EWfUf",buttons:"style_buttons__zf0nF"}},2698:function(e){e.exports={chat:"style_chat__ZTXhD",message:"style_message__uEVba"}},2723:function(e){e.exports={inactive:"style_inactive__B_gRa",fade:"style_fade__sZevv",alert:"style_alert__pv_lG",ad:"style_ad__2DN3O"}},1071:function(e){e.exports={tutorial:"style_tutorial__75p5w",step:"style_step__kswJY",fade:"style_fade__KaBU4",button:"style_button__rjKit"}}},function(e){e.O(0,[443,145,214,971,117,744],function(){return e(e.s=6124)}),_N_E=e.O()}]);