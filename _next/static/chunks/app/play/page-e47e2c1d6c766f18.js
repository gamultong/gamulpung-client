(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{3356:(e,t,n)=>{Promise.resolve().then(n.bind(n,6838))},6838:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>P});var r=n(5155),o=n(1269),l=n.n(o),i=n(2115);function s(){let[e,t]=(0,i.useState)({windowWidth:0,windowHeight:0});return(0,i.useEffect)(()=>{t({windowWidth:1.1*window.innerWidth,windowHeight:1.1*window.innerHeight});let e=()=>{t({windowWidth:1.1*window.innerWidth,windowHeight:1.1*window.innerHeight})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}let a=e=>{let t;let n=new Set,r=(e,r)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=r?r:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,l={setState:r,getState:o,getInitialState:()=>i,subscribe:e=>(n.add(e),()=>n.delete(e))},i=t=e(r,o,l);return l},c=e=>e?a(e):a,u=e=>e,d=e=>{let t=c(e),n=e=>(function(e,t=u){let n=i.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return i.useDebugValue(n),n})(t,e);return Object.assign(n,t),n},f=e=>e?d(e):d,h=f(e=>({id:"",x:100,y:100,color:"blue",originX:100,originY:100,zoom:1,setId:t=>e({id:t}),setColor:t=>e({color:t}),setX:t=>e({x:t}),setY:t=>e({y:t}),setZoom:t=>e({zoom:t}),goup:()=>e(e=>({originY:e.originY-1})),godown:()=>e(e=>({originY:e.originY+1})),goleft:()=>e(e=>({originX:e.originX-1})),goright:()=>e(e=>({originX:e.originX+1})),goUpLeft:()=>e(e=>({originX:e.originX-1,originY:e.originY-1})),goUpRight:()=>e(e=>({originX:e.originX+1,originY:e.originY-1})),goDownLeft:()=>e(e=>({originX:e.originX-1,originY:e.originY+1})),goDownRight:()=>e(e=>({originX:e.originX+1,originY:e.originY+1})),setOringinPosition:(t,n)=>e({originX:t,originY:n}),setPosition:(t,n)=>e({x:t,y:n})})),g=f(e=>({cursors:[],addCursors:t=>e(e=>({cursors:[...e.cursors,...t]})),removeCursor:t=>e(e=>({cursors:e.cursors.filter(e=>e!==t)})),setCursors:t=>e({cursors:t})}));var v=n(40),x=n.n(v);let y=JSON.parse('{"HP":{"inner":[["#8fe340","#A4E863"],["#62B628","#71C637"],["#F1FAD1","#E9F6B9"]],"outer":[["#A8EC67","#81D92C"],["#74C63C","#5BB31F"],["#E9FAAA","#F5FDD8"]]},"nf":["M219.428 109.389 C226.519 114.964 223.188 126.337 214.21 127.205 L79.8702 140.188 L115.929 28.0267 L219.428 109.389 Z","M79.9801 8.51632 C75.8798 9.72627 73.972 13.8825 73.0599 18.0591 L25.8244 234.356 C30.5707 235.401 36.0988 236 42 236 C45.1362 236 48.1671 235.831 51.0311 235.515 L116.451 28.5289 C117.573 24.9766 117.96 21.0358 115.39 18.3387 C112.87 15.6942 108.055 12.4097 98.862 9.69397 C89.7757 7.00975 83.7643 7.39963 79.9801 8.51632 Z"],"qN":[" M77.85 145.025 L0.899994 54.5752 L103.5 92.3752 L117 0.575195 L164.25 74.8252 L219.6 38.3752 L202.05 103.175 L276.3 108.575 L219.6 153.125 L287.1 223.325 L198 230.075 L177.75 312.425 L130.5 236.825 L67.05 284.075 L75.15 196.325 L11.7 177.425 L77.85 145.025 "," M67.05 104.525 L104.85 150.425 L71.1 169.325 L104.85 178.775 L100.8 226.025 L133.2 200.375 L158.85 239.525 L168.3 196.325 L218.25 192.275 L181.8 154.475 L212.85 131.525 L171 128.825 L181.8 93.7251 L152.1 113.975 L126.45 73.4751 L118.35 122.075 L67.05 104.525 "],"PN":"M12.2719 13.6437 C11.4141 6.37712 19.6676 1.61197 25.5317 5.9881 L165.217 110.229 C171.554 114.958 168.358 125.029 160.453 125.238 L100.228 126.83 C91.7695 127.053 83.9984 131.54 79.5756 138.753 L48.0844 190.114 C43.9511 196.855 33.6313 194.587 32.7043 186.735 L12.2719 13.6437 Z`","Ml":["#0059B280","#0095B280","#00B20080","#77B20080","#B2950080","#B24A0080","#B2000080","#7700B280"],"HG":["M129.815 125.662C130.503 123.446 133.497 123.446 134.185 125.662L139.22 141.887C139.527 142.878 140.409 143.549 141.404 143.549H157.699C159.924 143.549 160.849 146.53 159.049 147.899L145.866 157.927C145.061 158.539 144.724 159.625 145.032 160.616L150.067 176.841C150.755 179.057 148.333 180.899 146.533 179.53L133.35 169.502C132.545 168.89 131.455 168.89 130.65 169.502L117.467 179.53C115.667 180.899 113.245 179.057 113.933 176.841L118.968 160.616C119.276 159.625 118.939 158.539 118.134 157.927L104.951 147.899C103.151 146.53 104.076 143.549 106.301 143.549H122.596C123.591 143.549 124.473 142.878 124.78 141.887L129.815 125.662Z","M194.44 89.187C194.931 87.6043 197.069 87.6043 197.56 89.187L201.157 100.776C201.377 101.484 202.007 101.963 202.717 101.963H214.356C215.946 101.963 216.606 104.093 215.321 105.071L205.905 112.234C205.329 112.671 205.089 113.446 205.309 114.154L208.905 125.744C209.396 127.326 207.666 128.642 206.38 127.664L196.964 120.501C196.389 120.064 195.611 120.064 195.036 120.501L185.62 127.664C184.334 128.642 182.604 127.326 183.095 125.744L186.691 114.154C186.911 113.446 186.671 112.671 186.095 112.234L176.679 105.071C175.394 104.093 176.054 101.963 177.644 101.963H189.283C189.993 101.963 190.623 101.484 190.843 100.776L194.44 89.187Z","M170 93.7976C170 90.9223 167.92 88.439 165.054 88.2051C163.391 88.0694 161.705 88 160 88C139.889 88 122.445 97.66 113.794 111.795C111.465 115.603 114.57 120 119.034 120C121.483 120 123.681 118.599 125.072 116.583C131.592 107.134 144.005 100 160 100C160.973 100 161.933 100.026 162.879 100.078C166.586 100.281 170 97.5106 170 93.7976ZM206 132C202.686 132 200.06 134.723 199.266 137.94C196.313 149.9 184.652 160.816 167.768 163.416C164.571 163.908 162 166.522 162 169.756C162 173.154 164.823 175.908 168.191 175.457C190.725 172.44 208.443 157.177 211.524 137.977C212.049 134.705 209.314 132 206 132Z"]}'),C=f(e=>({x:1/0,y:1/0,content:"",movecost:0,setMovecost:t=>e({movecost:t}),setPosition:(t,n,r)=>e({x:t,y:n,content:r})})),p=f(e=>({socket:null,message:"",isOpen:!1,connect:t=>{let n=new WebSocket(t);n.onopen=()=>e({socket:n,isOpen:!0}),n.onclose=()=>e({socket:null,isOpen:!1}),n.onmessage=t=>e({message:t.data})},disconnect:()=>{e(e=>{var t;return null===(t=e.socket)||void 0===t||t.close(),{socket:null,isOpen:!1}})},sendMessage:t=>{t&&e(e=>{var n;return e.isOpen&&(null===(n=e.socket)||void 0===n||n.send(t)),{}})}}));var L=n(4706),w=n.n(L);function m(e){let{isClient:t,x:n,y:o,color:l,msg:s}=e,[a,c]=(0,i.useState)(s||""),[u,d]=(0,i.useState)(0),[f,h]=(0,i.useState)(0),{sendMessage:g}=p(),v=(0,i.useRef)(null),x=(0,i.useRef)(null),y=(0,i.useRef)();(0,i.useEffect)(()=>{x.current&&d(null==x?void 0:x.current.getBoundingClientRect().width)},[a]),(0,i.useEffect)(()=>{clearTimeout(y.current),f>0&&(y.current=setTimeout(()=>h(f-1),1e3))},[f]);let C=e=>{if("Enter"===e.key&&t){var n;h(8),null===(n=v.current)||void 0===n||n.focus()}"Escape"===e.key&&t&&(c(""),h(0))};return(0,i.useEffect)(()=>(window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)),[]),(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsxs)("form",{className:w().chat,onSubmit:e=>{e.preventDefault(),""===a||f<=0||(g(JSON.stringify({event:"send-chat",payload:{message:a}})),c(""))},style:{left:"51%",top:"51%",backgroundColor:l,opacity:f>4?1:f/4},children:[(0,r.jsx)("input",{type:"text",ref:v,className:w().message,value:a,maxLength:40,onChange:e=>{c(e.target.value),h(8)},style:{width:"".concat(u+5,"px"),color:"yellow"===l?"black":"white"}}),(0,r.jsx)("div",{ref:x,"aria-hidden":!0,children:a})]}),!t&&(0,r.jsx)("div",{className:w().chat,style:{left:"".concat(n,"%"),top:"".concat(o,"%"),backgroundColor:l},children:(0,r.jsx)("p",{className:w().message,children:a})})]})}class _{constructor(e,t){this.x=e,this.y=t,this.g=1/0,this.h=0,this.f=1/0,this.parent=null}}let E=e=>{let{paddingTiles:t,tiles:n,tileSize:o,cursorOriginX:l,cursorOriginY:a,startPoint:c,leftReviveTime:u,setCachingTiles:d}=e,[f,v]=[l-c.x,a-c.y],[L,w]=[(t-1)*f/t,(t-1)*v/t],{qN:E,PN:b,nf:S,HG:k,HP:F,Ml:j}=y,M={red:"#FF4D00",blue:"#0094FF",yellow:"#F0C800",purple:"#BC3FDC",0:"#FF4D00",1:"#F0C800",2:"#0094FF",3:"#BC3FDC"},R={red:"#FBCBB6",blue:"#A8DBFF",yellow:"#FFEE99",purple:"#E8BEF3",0:"#FBCBB6",1:"#A8DBFF",2:"#FFEE99",3:"#E8BEF3"},{windowHeight:B,windowWidth:D}=s(),{x:P,y:A,godown:N,goleft:O,goright:T,goup:Y,goDownLeft:I,goDownRight:X,goUpLeft:H,goUpRight:W,zoom:Z,color:z,setPosition:G}=h(),{setPosition:U,x:J,y:q,setMovecost:K}=C(),{cursors:V}=g(),{sendMessage:Q}=p(),$=(0,i.useRef)(null),ee={tileCanvasRef:(0,i.useRef)(null),interactionCanvasRef:(0,i.useRef)(null),otherCursorsRef:(0,i.useRef)(null),otherPointerRef:(0,i.useRef)(null)},[et,en]=(0,i.useState)(!0),[er,eo]=(0,i.useState)([]),[el,ei]=(0,i.useState)({x:0,y:0}),[es,ea]=(0,i.useState)([]),[ec,eu]=(0,i.useState)(),ed=()=>{$.current&&(clearInterval($.current),$.current=null)};(0,i.useEffect)(()=>{let e=e=>e.preventDefault();return window.addEventListener("contextmenu",e),()=>{window.removeEventListener("contextmenu",e),ed()}},[]);let ef=e=>!["F","C"].some(t=>e.includes(t)),eh=(e,t,n,r,l)=>{if($.current)return;let i=0,s=ew(f,v,e,t),a=s[i];if((null==a?void 0:a.x)===void 0||(null==a?void 0:a.y)===void 0)return;K(s.length-1),G(e+c.x,t+c.y);let u=(e,t)=>{let n=0,r=setInterval(()=>{let{tileCanvasRef:l,interactionCanvasRef:i,otherCursorsRef:s}=ee;if(!l.current||!i.current||!s.current)return;let a=[l.current,i.current,s.current];if(n>=1){for(let e of a)e.style.transform="0";clearInterval(r);return}let[c,u]=[e*(o-(n+=.03333333333333333)*o),t*(o-n*o)];for(let e of a)e.style.transform="translate(".concat(c,"px, ").concat(u,"px)")},200/30)};$.current=setInterval(()=>{if(++i>=s.length){eg(n,r,l),eo([]),ed();return}let e=s[i];if(!e)return;let[t,o]=[Math.sign(e.x-a.x),Math.sign(e.y-a.y)];1===t&&1===o?X():1===t&&-1===o?W():1===t&&0===o?T():-1===t&&1===o?I():-1===t&&-1===o?H():-1===t&&0===o?O():0===t&&1===o?N():0===t&&-1===o&&Y(),a=e,u(t,o),eo(s.slice(i))},200)},eg=(e,t,n)=>{Q(JSON.stringify({event:"pointing",payload:{position:{x:e,y:t},click_type:n}}))},ev=(e,t)=>{for(let[n,r]of[[-1,0],[0,-1],[0,1],[1,0],[-1,-1],[-1,1],[1,-1],[1,1]]){let[o,i]=[l+n,a+r];if(o===e&&i===t)return!0}return!1},ex=(e,t)=>{for(let[r,o]of[[0,0],[-1,0],[0,-1],[0,1],[1,0],[-1,-1],[-1,1],[1,-1],[1,1]]){let[l,i]=[e+r,t+o];if(i>=0&&i<n.length&&l>=0&&l<n[i].length&&ef(n[i][l]))return{x:l,y:i}}return{x:1/0,y:1/0}},ey=function(e,t,n,r,l){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=Z/3.5*i;if(e.fillStyle=r,e.save(),e.translate(t+o/6/i,n+o/6/i),e.scale(s,s),e.fill(null==ec?void 0:ec.cursor),e.restore(),l&&Date.now()<l&&(null==ec?void 0:ec.stun)){let r=Z/2*i;e.save(),e.translate(t-o/2/i,n-o/2/i),e.fillStyle="white",e.strokeStyle="black",e.scale(r,r);for(let t=0;t<(null==ec?void 0:ec.stun.length);t++)e.fill(ec.stun[t]),e.stroke(ec.stun[t])}e.restore()},eC=()=>{var e;let t=null===(e=ee.otherCursorsRef.current)||void 0===e?void 0:e.getContext("2d");t&&(t.clearRect(0,0,D,B),V.forEach(e=>{let[n,r]=[e.x-l+L,e.y-a+w];ey(t,n*o,r*o,M[e.color],e.revive_at||null)}))},ep=(e,t,n,r,l)=>{e&&(e.beginPath(),e.strokeStyle=r,e.lineWidth=l,e.strokeRect(t+l/2,n+l/2,o-l,o-l),e.closePath())},eL=e=>{var t;let n=null===(t=ee.otherPointerRef.current)||void 0===t?void 0:t.getContext("2d");n&&(n.clearRect(0,0,D,B),V.forEach(t=>{let[r,i]=[t.x-l+L,t.y-a+w];ep(n,r*o,i*o,R[t.color],e)}))},ew=(e,t,r,o)=>{let[l,i]=[new _(e,t),new _(r,o)],s=[...n.map(e=>[...e.map(()=>null)])];n.forEach((e,t)=>{e.forEach((e,n)=>{ef(e)&&(s[t][n]=new _(n,t))})});let a=[l],c=[];for(l.g=0,l.f=l.g+l.h;a.length>0;){let n=a.reduce((e,t)=>e.f<t.f?e:t);if(n.x===i.x&&n.y===i.y){let r=[],o=n;for(ei({x:o.x-e,y:o.y-t});o;)r.unshift(o),o=o.parent;return r}for(let{node:e,isDiagonal:t}of(a=a.filter(e=>e!==n),c.push(n),function(e,t){let n=[];for(let[r,o]of[[-1,0],[0,-1],[0,1],[1,0],[-1,-1],[-1,1],[1,-1],[1,1]]){let[l,i]=[t.x+r,t.y+o];i>=0&&i<e.length&&l>=0&&l<e[i].length&&null!==e[i][l]&&n.push({node:e[i][l],isDiagonal:0!==r&&0!==o})}return n}(s,n))){if(c.includes(e))continue;let r=n.g+(t?1.5:1);r>=e.g||(a.includes(e)||a.push(e),e.parent=n,e.g=r,e.h=Math.abs(e.x-i.x)+Math.abs(e.y-i.y),e.f=e.g+e.h)}}return[]},em=()=>{let e=ee.tileCanvasRef.current,r=ee.interactionCanvasRef.current;if(!e||!r||0===o)return;let i=e.getContext("2d"),s=r.getContext("2d");if(!i||!s)return;s.clearRect(0,0,D,B);let c=5*Z,u=f/t*o,d=v/t*o,h=u+(J-l)*o,g=d+(q-a)*o,x=new Path2D("\n      M0 0\n      L".concat(o," 0\n      L").concat(o," ").concat(o,"\n      L0 ").concat(o,"\n      L0 0\n      ")),y=new Path2D("\n      M".concat(c," ").concat(c,"\n      L").concat(o-c," ").concat(c,"\n      L").concat(o-c," ").concat(o-c,"\n      L").concat(c," ").concat(o-c,"\n      L").concat(c," ").concat(c,"\n      ")),C=M[z],p=P-l-L-el.x,m=A-a-w-el.y,_=[c,c,o-2*c,o-2*c],E=[0,0,o,o],b={inner:[i.createLinearGradient(..._),i.createLinearGradient(..._),i.createLinearGradient(..._)],outer:[i.createLinearGradient(...E),i.createLinearGradient(...E),i.createLinearGradient(...E)],flag:i.createLinearGradient(36.5,212.5,36.5,259)};b.flag.addColorStop(0,"#E8E8E8"),b.flag.addColorStop(1,"transparent"),b.inner.forEach((e,t)=>{e.addColorStop(0,F.inner[t][0]),e.addColorStop(1,F.inner[t][1])}),b.outer.forEach((e,t)=>{e.addColorStop(0,F.outer[t][0]),e.addColorStop(.4,F.outer[t][0]),e.addColorStop(.6,F.outer[t][1]),e.addColorStop(1,F.outer[t][1])}),null==n||n.forEach((e,t)=>{if(null==e||e.forEach((e,n)=>{var r;if((null===(r=es[t])||void 0===r?void 0:r[n])===e)return;let[l,a]=[(n-L)*o,(t-w)*o];if(!(l<-o)&&!(a<-o)&&!(l>D+o)&&!(a>B+o)){switch(i.save(),i.translate(l,a),e){case"C0":case"C1":case"F00":case"F01":case"FRED0":case"FRED1":case"F10":case"F11":case"FYELLOW0":case"FYELLOW1":case"F20":case"F21":case"FBLUE0":case"FBLUE1":case"F30":case"F31":case"FPURPLE0":case"FPURPLE1":{let r="0"===e.slice(-1)?0:1;if(i.fillStyle=b.outer[r],1>=Math.abs(t-v)&&1>=Math.abs(n-f)&&!(n===f&&t===v)&&e.includes("C")&&(ey(s,l,a,"#0000002f",null,.5),i.fillStyle="white"),i.fill(x),i.fillStyle=b.inner[r],i.fill(y),!e.includes("F"))break;i.restore(),i.save(),i.translate(l+o/6,a+o/6),i.scale(Z/4.5,Z/4.5),i.fillStyle=M[e.slice(1,-1).toLowerCase()],i.fill(null==ec?void 0:ec.flag.flag),i.fillStyle=b.flag,i.fill(null==ec?void 0:ec.flag.pole);break}case"O":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"B":if(i.fillStyle=b.outer[2],i.fill(x),i.fillStyle=b.inner[2],i.fill(y),"B"===e&&(i.scale(Z/4,Z/4),i.fillStyle="rgba(0, 0, 0, 0.6)",i.fill(null==ec?void 0:ec.boom.inner),i.fillStyle="rgba(0, 0, 0, 0.5)",i.fill(null==ec?void 0:ec.boom.outer)),i.restore(),parseInt(e)>0){let t=parseInt(e)-1;i.fillStyle=j[t],i.font=50*Z+"px LOTTERIACHAB",i.textAlign="center",i.textBaseline="middle",i.fillText(e,l+o/2,a+o/2)}}i.restore()}}),t===Math.floor(3*n.length/10)){if(ey(s,u,d,C,null),ep(s,h,g,C,c),eC(),eL(c),er.length>0){let[e,t]=[er[0].x+p+.5,er[0].y+m+.5];s.beginPath(),s.strokeStyle="black",s.lineWidth=o/6,s.moveTo(e*o,t*o),er.forEach(e=>{let[t,n]=[e.x+p+.5,e.y+m+.5];s.lineTo(t*o,n*o)}),s.stroke()}ea(n)}})};return(0,i.useEffect)(()=>{if(!et){em();return}let e=new FontFace("LOTTERIACHAB","url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2302@1.0/LOTTERIACHAB.woff2') format('woff2')");Promise.all([e.load()]).then(()=>{eu({cursor:new Path2D(b),stun:[new Path2D(k[0]),new Path2D(k[1]),new Path2D(k[2])],flag:{flag:new Path2D(S[0]),pole:new Path2D(S[1])},boom:{inner:new Path2D(E[0]),outer:new Path2D(E[1])}}),en(!1),document.fonts.add(e)})},[n,et,o,l,a,c,J,q,z,Z]),(0,i.useEffect)(()=>{eC(),eL(5*Z)},[V]),(0,r.jsx)(r.Fragment,{children:et?(0,r.jsxs)("div",{className:x().loading,children:[(0,r.jsx)("h1",{children:"Loading..."}),(0,r.jsx)("div",{className:"".concat(n.length<1?x().loadingBar:x().loadComplete)})]}):(0,r.jsxs)("div",{className:"".concat(x().canvasContainer," ").concat(u>0?x().vibration:""),children:[(0,r.jsx)(m,{color:z,isClient:!0,x:l,y:a}),(0,r.jsx)("canvas",{className:x().canvas,id:"TileCanvas",ref:ee.tileCanvasRef,width:D,height:B}),(0,r.jsx)("canvas",{className:x().canvas,id:"OtherCursors",ref:ee.otherCursorsRef,width:D,height:B}),(0,r.jsx)("canvas",{className:x().canvas,id:"OtherPointer",ref:ee.otherPointerRef,width:D,height:B}),(0,r.jsx)("canvas",{className:x().canvas,id:"InteractionCanvas",ref:ee.interactionCanvasRef,width:D,height:B,onPointerDown:e=>{var t,r;let l=ee.tileCanvasRef.current;if(!l)return;let{left:i,top:s}=l.getBoundingClientRect(),[a,u]=[e.clientX-i,e.clientY-s],[f,h]=[Math.floor(a/o+L),Math.floor(u/o+w)],[g,v]=[Math.round(f+c.x),Math.round(h+c.y)];U(g,v,null!==(r=null===(t=n[h])||void 0===t?void 0:t[f])&&void 0!==r?r:"Out of bounds");let x=2===e.buttons?"SPECIAL_CLICK":"GENERAL_CLICK";if(eg(g,v,x),$.current&&(ed(),d(n)),ev(g,v)){eh(f,h,g,v,x);return}let{x:y,y:C}=ex(f,h);eh(y,C,g,v,x)}})]})})};var b=n(8871),S=n.n(b);function k(e){let{time:t}=e;return(0,r.jsxs)("div",{className:S().inactive,children:[(0,r.jsxs)("div",{className:S().alert,children:[(0,r.jsx)("p",{children:"You`re stunned!"}),(0,r.jsx)("p",{children:"Try Again After"}),(0,r.jsxs)("p",{children:[Math.floor(t/60),":",(t%60).toString().padStart(2,"0")]})]}),(0,r.jsx)("div",{className:S().ad,children:"광고 받습니다: kkh061101@naver.com"})]})}var F=n(7350),j=n.n(F);function M(){return(0,r.jsx)("svg",{width:"22",height:"26",viewBox:"0 0 22 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M0.436226 1.88654C0.321855 0.917668 1.42232 0.282312 2.2042 0.865797L20.8289 14.7645C21.6738 15.3951 21.2476 16.7379 20.1937 16.7657L12.1637 16.978C11.0359 17.0078 9.99976 17.606 9.41006 18.5678L5.21123 25.4159C4.66013 26.3147 3.28415 26.0124 3.16055 24.9653L0.436226 1.88654Z",fill:"white"})})}function R(){return(0,r.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M20 5L26 5C26.5523 5 27 5.44772 27 6L27 12",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,r.jsx)("path",{d:"M12 27L6 27C5.44772 27 5 26.5523 5 26L5 20",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,r.jsx)("path",{d:"M5 12L5 6C5 5.44772 5.44772 5 6 5L12 5",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),(0,r.jsx)("path",{d:"M27 20L27 26C27 26.5523 26.5523 27 26 27L20 27",stroke:"white",strokeWidth:"4",strokeLinecap:"round"})]})}function B(){return(0,r.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("circle",{cx:"14",cy:"14",r:"9",stroke:"white",strokeWidth:"4"}),(0,r.jsx)("path",{d:"M27 27L21.5 21.5",stroke:"white",strokeWidth:"4",strokeLinecap:"round"})]})}function D(){let{zoom:e,setZoom:t,originX:n,originY:o}=h(),{x:l,y:i}=C();return(0,r.jsxs)("div",{className:j().dashboard,children:[(0,r.jsxs)("div",{className:j().coordinates,children:[(0,r.jsxs)("p",{children:["\xa0",(0,r.jsx)(M,{}),"(",n,", ",o,")"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)(R,{}),"\xa0(",l===1/0?"":l,", ",i===1/0?"":i,")"]})]}),(0,r.jsxs)("div",{className:j().zoom,children:[(0,r.jsxs)("p",{children:[(0,r.jsx)(B,{}),"\xa0",Math.ceil(100*e),"%"]}),(0,r.jsxs)("div",{className:j().buttons,children:[(0,r.jsx)("button",{onPointerDown:()=>t(e/1.5>.15?e/1.5:e),children:"-"}),(0,r.jsx)("button",{onPointerDown:()=>t(1.5*e<1.7?1.5*e:e),children:"+"})]})]})]})}function P(){let e="".concat("wss://a4ed-152-67-203-244.ngrok-free.app","/session"),{isOpen:t,message:n,sendMessage:o,connect:a,disconnect:c}=p(),{x:u,y:d,setColor:f,setPosition:v,zoom:x,setZoom:y,originX:L,originY:w,setOringinPosition:m,setId:_}=h(),{setCursors:b,addCursors:S,cursors:F}=g(),{setPosition:j}=C(),{windowWidth:M,windowHeight:R}=s(),[B,P]=(0,i.useState)(0),[A,N]=(0,i.useState)({x:0,y:0}),[O,T]=(0,i.useState)({x:0,y:0}),[Y,I]=(0,i.useState)({x:0,y:0}),[X,H]=(0,i.useState)([]),[W,Z]=(0,i.useState)([...X.map(e=>[...e])]),[z,G]=(0,i.useState)(-1),[U,J]=(0,i.useState)(!1),q=(e,n,r,l,i)=>{if(!t||!U)return;let[s,a]=[Math.abs(r-e)+1,Math.abs(n-l)+1];H(e=>{let t=[...e];switch(i){case"U":for(let e=0;e<a;e++)t.unshift([...Array(s).fill("??")]),t.pop();break;case"D":for(let e=0;e<a;e++)t.push([...Array(s).fill("??")]),t.shift();break;case"L":for(let e=0;e<a;e++)t[e]=[...Array(s).fill("??"),...t[e].slice(0,-1)];break;case"R":for(let e=0;e<a;e++)t[e]=[...t[e].slice(s,t[0].length),...Array(s).fill("??")];break;case"A":t=Array.from({length:a},()=>Array.from({length:s},()=>"??"))}return t}),o(JSON.stringify({event:"fetch-tiles",payload:{start_p:{x:e,y:n},end_p:{x:r,y:l}}}))};(0,i.useEffect)(()=>(document.documentElement.style.overflow="hidden",J(!1),y(1),()=>{document.documentElement.style.overflow="auto",c()}),[]),(0,i.useEffect)(()=>{if(!t&&A.x!==O.x&&O.y!==A.y){G(-1);let[t,n]=[O.x-A.x+1,O.y-A.y+1];a(e+"?view_width=".concat(t,"&view_height=").concat(n))}},[t,A,O]);let K=e=>{let t=e.match(/.{1,2}/g);if(!t)return"";let n=t.map(e=>parseInt(e,16).toString(2).padStart(8,"0")).join(""),r="1"===n[0],o="1"===n[1],l="1"===n[2],i=parseInt(n.slice(3,5),2).toString(),s=parseInt(n.slice(5),2);return r?o?"B":0===s?"O":s.toString():l?"F"+i:"C"},V=(e,t,n,r,o)=>{let[l,i]=[2*Math.abs(e-n+1),Math.abs(r-t+1)],s=[];for(let e=0;e<i;e++){let t=[],n=o.slice(e*l,(e+1)*l);for(let e=0;e<l/2;e++){let r=n.slice(2*e,2*e+2);t[e]=K(r)}s[e]=t}return s.reverse(),{rowlength:l,columnlength:i,sortedTiles:s}},Q=(e,t,n,r,o,l)=>{if(0===o.length)return;let{rowlength:i,columnlength:s,sortedTiles:a}=V(e,t,n,r,o),c=[...X];for(let e=0;e<s;e++){var u;let r=e;"All"===l&&d<t&&(r+=O.y-A.y-s+1),"PART"===l&&(r+=t-A.y),c[r]=null!==(u=c[r])&&void 0!==u?u:[];for(let o=0;o<i;o++){let l=a[e][o];["C","F"].some(e=>null==l?void 0:l.includes(e))&&(l+=(e-t+o-n)%2==0?"0":"1"),l&&(c[r][o+n-A.x]=l)}}H(c)};return(0,i.useEffect)(()=>{if(n)try{var e,t;let{event:r,payload:o}=JSON.parse(n);switch(r){case"tiles":{let{tiles:e,start_p:t,end_p:n}=o,{x:r,y:l}=t,{x:i,y:s}=n;Q(i,s,r,l,e,"All");break}case"flag-set":{let{position:e,is_set:t,color:n}=o,{x:r,y:l}=e,i=[...X];i[l-A.y][r-A.x]=(t?"F"+n:"C")+((r+l)%2==0?"0":"1"),H(i);break}case"pointer-set":{let{id:e,pointer:t}=o,n=F.map(n=>e===n.id?{...n,pointer:t}:n);b(n)}case"single-tile-opened":{let{position:e,tile:t}=o;if(!e||!t)return;let{x:n,y:r}=e,l=[...X];l[r-A.y][n-A.x]=K(t),H(l);break}case"tiles-opened":{let{tiles:e,start_p:t,end_p:n}=o,{x:r,y:l}=t,{x:i,y:s}=n;Q(i,s,r,l,e,"PART");break}case"my-cursor":{let{position:e,pointer:t,color:n,id:r}=o;_(r),m(e.x,e.y),v(e.x,e.y),f(n.toLowerCase()),t&&j(t.x,t.y,""),setTimeout(()=>J(!0),0);break}case"you-died":{let{revive_at:t}=o,n=Math.floor((((e=new Date(t),void 0===e)?void 0:e.getTime())-Date.now())/1e3);G(n);break}case"cursors":{let{cursors:e}=o,t=e.map(e=>{let{position:{x:t,y:n},color:r,id:o,pointer:l}=e;return{id:o,pointer:l,x:t,y:n,color:r.toLowerCase()}});S(t);break}case"cursors-died":{let{cursors:e,revive_at:n}=o,r=(t=new Date(n),void 0===t)?void 0:t.getTime(),l=F.map(t=>{for(let n of e)if(t.id===n.id)return{...t,revive_at:r};return t});b(l);break}case"moved":{let{id:e,new_position:t}=o,{x:n,y:r}=t,l=F.map(t=>e===t.id?{...t,x:n,y:r}:t);b(l);break}case"cursor-quit":{let{id:e}=o,t=[...F],n=t.findIndex(t=>t.id===e);-1!==n&&t.splice(n,1),b(t);break}case"send-chat":{let{position:e,message:t,color:n}=o,{x:r,y:l}=e;console.log(r,l,t,n);break}case"error":{let{msg:e}=o;console.error(e)}}}catch(e){console.error(e)}},[n]),(0,i.useEffect)(()=>{let e=[...X.map(e=>[...e.map(()=>"??")])];for(let r=0;r<X.length;r++){let o=r+w-d;for(let l=0;l<X[r].length;l++){var t,n;let i=l+L-u;(null===(t=X[o])||void 0===t?void 0:t[i])&&(e[r][l]=(null===(n=X[o])||void 0===n?void 0:n[i])||"??")}}Z(e)},[X,L,w]),(0,i.useEffect)(()=>{let e=80*x,[t,n]=[Math.floor(2*M/e/2),Math.floor(2*R/e/2)];n<1||t<1||(N({x:u-t,y:d-n}),T({x:u+t,y:d+n}),I({x:L-t,y:w-n}),P(e))},[M,R,x,L,w,u,d,2,U]),(0,i.useEffect)(()=>{if(!U)return;let e=80*x,[t,n]=[Math.floor(2*M/e),Math.floor(2*R/e)],[r,l]=[Math.floor(t/2),Math.floor(n/2)],[i,s]=[0,0];t>O.x-A.x+1||n>O.y-A.y+1?(i=Math.floor(l-(O.y-A.y)/2),s=Math.round(r-(O.x-A.x)/2)):(i=-Math.round((O.y-A.y-n)/2),s=-Math.round((O.x-A.x-t)/2)),q(A.x-s,O.y+i,O.x+s,A.y-i,"A"),o(JSON.stringify({event:"set-view-size",payload:{width:Math.floor(Math.floor(2*M/e)),height:Math.floor(Math.floor(2*R/e))}}))},[M,R,x,2,U]),(0,i.useEffect)(()=>{let[e,t]=[u-L,d-w],[n,r]=[e<0,e>0],[o,l]=[t<0,t>0],{upfrom:i,upto:s,downfrom:a,downto:c,leftfrom:f,leftto:h,rightfrom:g,rightto:v}={upfrom:A.y-1,upto:A.y+t,downfrom:O.y+t,downto:O.y+1,leftfrom:A.x+e,leftto:A.x-1,rightfrom:O.x+1,rightto:O.x+e};r&&l?(q(g,a,v,s,"R"),q(f,a,v,c,"D")):n&&l?(q(f,a,h,s,"L"),q(f,a,v,c,"D")):r&&o?(q(g,a,v,s,"R"),q(f,i,v,s,"U")):n&&o?(q(f,a,h,s,"L"),q(f,i,v,s,"U")):r?q(g,O.y,v,A.y,"R"):n?q(f,O.y,h,A.y,"L"):l?q(A.x,a,O.x,c,"D"):o&&q(A.x,i,O.x,s,"U")},[u,d]),(0,i.useEffect)(()=>{U&&o(JSON.stringify({event:"moving",payload:{position:{x:L,y:w}}}))},[L,w]),(0,i.useEffect)(()=>{setTimeout(()=>G(e=>e>0?--e:e),1e3)},[z]),(0,r.jsxs)("div",{className:l().page,children:[z>0&&(0,r.jsx)(k,{time:z}),(0,r.jsx)(D,{}),(0,r.jsx)(E,{leftReviveTime:z,paddingTiles:2,tiles:W,setCachingTiles:H,tileSize:B,startPoint:Y,cursorOriginX:L,cursorOriginY:w})]})}},1269:e=>{e.exports={page:"page_page__9CbJ0"}},40:e=>{e.exports={loading:"style_loading__42LVe",loadingBar:"style_loadingBar__AtBJr",loadingAnimation:"style_loadingAnimation__ScSQQ",loadComplete:"style_loadComplete__SRD5Z",canvasContainer:"style_canvasContainer__nKMjH",canvas:"style_canvas__m8mJO",vibration:"style_vibration__6_Fiw"}},7350:e=>{e.exports={dashboard:"style_dashboard__nDsof",coordinates:"style_coordinates__3RzzR",zoom:"style_zoom__EWfUf",buttons:"style_buttons__zf0nF"}},4706:e=>{e.exports={chat:"style_chat__ZTXhD",message:"style_message__uEVba"}},8871:e=>{e.exports={inactive:"style_inactive__B_gRa",fade:"style_fade__sZevv",alert:"style_alert__pv_lG",ad:"style_ad__2DN3O"}}},e=>{var t=t=>e(e.s=t);e.O(0,[31,441,517,358],()=>t(3356)),_N_E=e.O()}]);